(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["app~2c2561fe"],{

/***/ "7jDb":
/*!****************************!*\
  !*** ./src/IgorJs/main.js ***!
  \****************************/
/*! exports provided: IgorUtils, IgorRunner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"IgorUtils\", function() { return IgorUtils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"IgorRunner\", function() { return IgorRunner; });\n/* harmony import */ var ticker__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ticker */ \"rOV7\");\n/* harmony import */ var idb_keyval__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! idb-keyval */ \"ztCj\");\n/* harmony import */ var resources_types_KVSMap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! resources/types/KVSMap */ \"zYKg\");\n/* harmony import */ var resources_types_TagsProxy__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! resources/types/TagsProxy */ \"By/q\");\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } it = o[Symbol.iterator](); return it.next.bind(it); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\nvar IgorCore = {\n  tick_entities: [],\n  object_tickers: {},\n  game: {},\n  // Tis the base game json\n  objs: new Map(),\n  namedObjs: [],\n  $_tags: new resources_types_KVSMap__WEBPACK_IMPORTED_MODULE_2__[\"default\"](),\n  meta: {},\n  // Contains all the runtime data\n  ops: {},\n  statics: {},\n  control: {\n    obj_counter: 0\n  },\n  metaDefines: {// As meta, but organized by object types and direct paths\n  },\n  Tick: function Tick(td) {\n    var _loop = function _loop() {\n      var each = _step.value;\n      if (!each._tags.tick) return \"continue\";\n      var order = IgorCore.object_tickers[each.$_type].$_signalOrders;\n\n      if (order) {\n        order.forEach(function (x) {\n          if (each._tags[x]) IgorCore.object_tickers[each.$_type][x].fn(each, td, IgorRunner);\n        });\n      } else {\n        IgorCore.object_tickers[each.$_type].tick.fn(each, td, IgorRunner);\n      }\n    };\n\n    for (var _iterator = _createForOfIteratorHelperLoose(IgorCore.tick_entities.values()), _step; !(_step = _iterator()).done;) {\n      var _ret = _loop();\n\n      if (_ret === \"continue\") continue;\n    }\n  },\n  Tick_Builder: function Tick_Builder(td) {\n    var ret = {};\n    Object.assign(ret, td); // Lookup tick data signature\n    //  execute callbacks to acquire data\n\n    return ret;\n  },\n  IgorBuilder: IgorBuilder,\n  config: {}\n}; //* IgorBuilder should only called/accessed from within\n//  the Igor scope, it's internally used by the Igor Engine\n//  to manipulate the lifecycle of it's objects\n\nvar IgorBuilder = {\n  get data() {\n    return IgorCore.data;\n  },\n\n  getNamedObject: function getNamedObject(what) {\n    return IgorCore.namedObjs[what];\n  },\n  newObject: function newObject(type, subType, parent) {\n    var obj = {\n      $_id: \"id_\" + IgorCore.control.obj_counter++,\n      $_type: type,\n      $_subType: subType,\n      $_parent: (parent == null ? void 0 : parent.$_id) || parent\n    };\n    obj.$_tags = Object(resources_types_TagsProxy__WEBPACK_IMPORTED_MODULE_3__[\"TagMapProxy\"])({\n      to: IgorCore.$_tags,\n      entity: obj\n    });\n    IgorCore.objs.set(obj.$_id, obj);\n    return obj;\n  },\n  newComponent: function newComponent(objType, params, parent) {\n    if (IgorCore.metaDefines[objType]) {\n      var _IgorCore$metaDefines = IgorCore.metaDefines[objType].new(params, IgorBuilder.newObject(objType, \"\", parent), IgorBuilder),\n          obj = _IgorCore$metaDefines[0],\n          cmds = _IgorCore$metaDefines[1];\n\n      if (IgorCore.object_tickers[objType]) {\n        IgorCore.tick_entities.push(obj);\n      }\n\n      return obj.$_id;\n    } else {\n      console.warn(\"cannot find object type\");\n      debugger;\n      return false;\n    }\n  }\n};\nvar IgorUtils = {\n  initialize: function initialize(obj) {\n    IgorCore.graphics = obj.viewTasker;\n    IgorCore.command = obj.commandTasker;\n    IgorCore.ticker = new ticker__WEBPACK_IMPORTED_MODULE_0__[\"default\"](obj.ticker.ticks_perSec, obj.ticker.ticks_maxPhase, IgorCore.graphics.signaler);\n    IgorCore.config.TICKS_PER_SECOND = obj.ticker.ticks_perSec;\n    IgorCore.statics[\"config.TICKS_PER_SECOND\"] = obj.ticker.ticks_perSec;\n    IgorUtils.Ticker = IgorCore.ticker;\n    IgorCore.ticker_sub = IgorCore.ticker.subscribe(IgorCore.Tick);\n    IgorCore.dbName = obj.dbName;\n    IgorCore.saveName = obj.saveName;\n    IgorCore.db = new idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"Store\"](IgorCore.dbName, \"store\");\n\n    if (IgorCore._provideTemp) {\n      IgorCore._provideTemp.forEach(function (elm) {\n        IgorCore.command.provide(elm.item, elm.fn, elm.sig, elm.valid);\n      });\n    }\n\n    if (IgorCore._utilityTemp) {\n      IgorCore._utilityTemp.forEach(function (elm) {\n        return IgorCore.command.utilityFn(elm.named, elm.fn);\n      });\n    }\n  },\n  provide_CCC: function provide_CCC(item, fn, sig, valid) {\n    //! Provides temporary passthrough for game commands\n    //    so game action definitions won't reference CephlaComm directly\n    if (!IgorCore.command) {\n      IgorCore._provideTemp || (IgorCore._provideTemp = []);\n\n      IgorCore._provideTemp.push({\n        item: item,\n        fn: fn,\n        sig: sig,\n        valid: valid\n      });\n    } else {\n      IgorCore.command.provide(item, fn, sig, valid);\n    }\n  },\n  CCC_addUtility: function CCC_addUtility(named, fn) {\n    if (!IgorCore.command) {\n      IgorCore._utilityTemp || (IgorCore._utilityTemp = []);\n\n      IgorCore._utilityTemp.push({\n        named: named,\n        fn: fn\n      });\n    } else {\n      IgorCore.command.utilityFn(named, fn);\n    }\n  },\n  defineObj: function defineObj(who, fn, actions) {\n    IgorCore.metaDefines[who] = {\n      new: fn,\n      _delete: fn._delete,\n      _signal: fn._signal,\n      actions: actions\n    };\n\n    if (actions == null ? void 0 : actions.tick) {\n      !IgorCore.object_tickers[who] && (IgorCore.object_tickers[who] = {});\n      IgorCore.object_tickers[who].tick = {\n        type: who,\n        fn: actions.tick\n      };\n    }\n\n    actions && Object.entries(actions).forEach(function (_ref) {\n      var prop = _ref[0],\n          obj = _ref[1];\n      if (obj && obj.CC_provide) IgorUtils.provide_CCC(obj.CC_provide, obj, obj.signature, obj.validator);\n      if (obj && obj.Igor_operation) IgorUtils.addOperation(obj.Igor_operation, obj);\n      if (obj && obj.CC_utility) IgorUtils.CCC_addUtility(obj.CC_utility, obj);\n    });\n  },\n  setStatic: function setStatic(name, as) {\n    Object.defineProperty(IgorCore.statics, name, {\n      value: as,\n      writable: false\n    });\n  },\n  addOperation: function addOperation(op, fn) {\n    //* These functions are only accessible from game codes\n    // Their signature shouldn't need to be known\n    IgorCore.ops[op] = {\n      fn: fn\n    };\n  },\n  //! I don't really like this implementation\n  // I need a way to provide different tick processors for different tags\n  // tickDataSig would be the needed parameters from the passed TickData\n  addObjectTickHandler: function addObjectTickHandler(who, what, named, priority) {\n    !IgorCore.object_tickers[who] && (IgorCore.object_tickers[who] = {});\n    var at = IgorCore.object_tickers[who];\n    at[named] = {\n      type: who,\n      fn: what,\n      priority: priority\n    }; //Regenerate priorities... add to base object_tickers\n\n    var order = at.$_signalOrders || [\"tick\"];\n    var tickIdx = order.findIndex(function (x) {\n      return x == \"tick\";\n    });\n\n    if (priority.chain) {\n      //! Lots more needed for this...\n      // need to account for priorities\n      [].splice.apply(order, [tickIdx, 1].concat(priority.chain));\n    } else if (priority.num) {//... also if no chain exists...\n    }\n\n    at.$_signalOrders = order;\n  },\n  loadDatabase: function loadDatabase(dataset) {\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              IgorCore.data = dataset; //Iterate through data objects\n              // pass required info into Graphics and Command processors\n              //If save loaded,\n\n              _context.next = 3;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"get\"])(IgorCore.saveName, IgorCore.db);\n\n            case 3:\n              IgorCore.save = _context.sent;\n\n              if (IgorCore.save) {\n                IgorCore.game = JSON.parse(IgorCore.save.game);\n                IgorCore.objs = new Map(JSON.parse(IgorCore.save.objs));\n                if (IgorCore.save.control) IgorCore.control = JSON.parse(IgorCore.save.control); //Reconnect tags\n\n                IgorCore.objs.forEach(function (x) {\n                  x.$_tags = Object(resources_types_TagsProxy__WEBPACK_IMPORTED_MODULE_3__[\"TagMapProxy\"])({\n                    to: IgorCore.$_tags,\n                    entity: x,\n                    load: x.$_tags\n                  });\n                  if (IgorCore.object_tickers[x.$_type]) IgorCore.tick_entities.push(x);\n                }); //console.log('found save')\n              } else {\n                //Create new game\n                IgorCore.game = IgorCore.metaDefines['#'].new; //console.log('new game')\n              } //console.log('db loaded')\n\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  setNamed: function setNamed(as, who) {\n    IgorCore.namedObjs[as] = who;\n  },\n  getObjId: function getObjId(id, doubleProp) {\n    if (!doubleProp) return IgorCore.objs.get(id);\n    var obj = IgorCore.objs.get(id);\n    obj = Object.walkPath(obj, doubleProp);\n    return IgorCore.objs.get(obj);\n  },\n  arrayFromIds: function arrayFromIds(list) {\n    if (!list) return [];\n    var ret = [];\n    list.forEach(function (id) {\n      ret.push(IgorCore.objs.get(id));\n    });\n    return ret;\n  },\n  getRunner: function getRunner() {\n    return IgorRunner;\n  },\n\n  get globalObject() {\n    return IgorCore.game;\n  },\n\n  get dataSet() {\n    return IgorCore.data;\n  },\n\n  get: function get(named, specifiers) {\n    return IgorCore.objects_by_name();\n  },\n  saveGame: function saveGame() {\n    console.log(\"Game saving...\");\n    var data = {\n      game: JSON.stringify(IgorCore.game),\n      objs: JSON.stringify(Array.from(IgorCore.objs.entries())),\n      control: JSON.stringify(IgorCore.control)\n    };\n    Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"set\"])(IgorCore.saveName, data, IgorCore.db);\n  },\n  backupSave: function backupSave() {\n    var data = {\n      game: JSON.stringify(IgorCore.game),\n      objs: JSON.stringify(Array.from(IgorCore.objs.entries()))\n    };\n    Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"set\"])(\"SaveGame_bak\", data, IgorCore.db);\n  },\n  loadBackup: function loadBackup() {\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      var save;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"get\"])(\"SaveGame_bak\", IgorCore.db);\n\n            case 2:\n              save = _context2.sent;\n              IgorCore.game = JSON.parse(save.game);\n              IgorCore.objs = new Map(JSON.parse(save.objs));\n              IgorCore.objs.forEach(function (x) {\n                x.$_tags = Object(resources_types_TagsProxy__WEBPACK_IMPORTED_MODULE_3__[\"TagMapProxy\"])({\n                  to: IgorCore.$_tags,\n                  entity: x,\n                  load: x.$_tags\n                });\n                if (IgorCore.object_tickers[x.$_type]) IgorCore.tick_entities.push(x);\n              });\n              console.log(\"backup loaded\");\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  setState: function setState(which) {\n    switch (which) {\n      case \"start\":\n        IgorCore.graphics.signaler.signal(\"generalUpdate\");\n        IgorCore.graphics.signaler.signal(\"entityUpdate\");\n        IgorCore.graphics.signaler.signal(\"techResearched\");\n        IgorCore.ticker.resume();\n        break;\n\n      case \"stop\":\n        IgorCore.ticker.pause();\n        break;\n\n      case \"tick\":\n        IgorCore.ticker.once();\n        break;\n\n      case \"toggle\":\n        IgorCore.ticker.toggle();\n\n        if (IgorCore.ticker.isRunning) {\n          IgorCore.graphics.signaler.signal(\"generalUpdate\");\n          IgorCore.graphics.signaler.signal(\"entityUpdate\");\n          IgorCore.graphics.signaler.signal(\"techResearched\");\n        }\n\n        break;\n\n      default:\n        console.warn(\"IGOR: setting unknown state\");\n    }\n  },\n  commands: function commands(what, params) {\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n      var save;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = what;\n              _context3.next = _context3.t0 === \"resetSave\" ? 3 : _context3.t0 === \"copySave\" ? 6 : _context3.t0 === \"storeSave\" ? 10 : _context3.t0 === \"backupSave\" ? 13 : _context3.t0 === \"restoreBackupSave\" ? 15 : 20;\n              break;\n\n            case 3:\n              _context3.next = 5;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"del\"])(IgorCore.saveName, IgorCore.db);\n\n            case 5:\n              return _context3.abrupt(\"return\", true);\n\n            case 6:\n              _context3.next = 8;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"get\"])(IgorCore.saveName, IgorCore.db);\n\n            case 8:\n              window.tfmg_save = _context3.sent;\n              return _context3.abrupt(\"return\", \"done\");\n\n            case 10:\n              _context3.next = 12;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"set\"])(IgorCore.saveName, params, IgorCore.db);\n\n            case 12:\n              return _context3.abrupt(\"return\", \"done\");\n\n            case 13:\n              IgorUtils.backupSave();\n              return _context3.abrupt(\"return\", \"done\");\n\n            case 15:\n              _context3.next = 17;\n              return Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"get\"])(\"SaveGame_bak\", IgorCore.db);\n\n            case 17:\n              save = _context3.sent;\n              Object(idb_keyval__WEBPACK_IMPORTED_MODULE_1__[\"set\"])(IgorCore.saveName, save, IgorCore.db);\n              return _context3.abrupt(\"return\", \"done\");\n\n            case 20:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  }\n}; //  The purpose of IgorRunner is to accept commands from external sources, and process them into the\n//  Igor environment\n//The IgorRunner is passed to GameObjectActionFunctions so they may emit events or get data\n\nvar IgorRunner = {\n  emit: function emit() {//I emit events into Igor\n  },\n\n  get data() {\n    return IgorCore.data;\n  },\n\n  get view() {\n    return IgorCore.graphics;\n  },\n\n  get config() {\n    return IgorCore.config;\n  },\n\n  processTEMP: function processTEMP(obj, op, args) {\n    var ret = {};\n\n    if (typeof obj == \"string\") {\n      if (obj.includes(\"id\")) {\n        obj = IgorCore.objs.get(obj);\n      } else {\n        var temp = IgorCore.namedObjs[obj];\n        if (temp) obj = temp;\n      }\n    }\n\n    IgorCore.ops[op].fn(obj, args, ret, IgorRunner, IgorCore.ops[op].fn); //console.log('_result' in ret)\n\n    return '_result' in ret ? ret._result : ret;\n  },\n  getNamedObject: function getNamedObject(what) {\n    return IgorCore.namedObjs[what];\n  },\n  getId: function getId(which, doubleProp) {\n    if (!doubleProp) return IgorCore.objs.get(which);\n    var obj = IgorCore.objs.get(which);\n    obj = Object.walkPath(obj, doubleProp);\n    return IgorCore.objs.get(obj);\n  },\n  getStatic: function getStatic(which) {\n    return IgorCore.statics[which];\n  },\n  updateStatic: function updateStatic(which, is) {\n    IgorCore.statics[which] = is;\n  },\n  newComponent: function newComponent(objType, params) {\n    if (IgorCore.metaDefines[objType]) {\n      var _IgorCore$metaDefines2 = IgorCore.metaDefines[objType].new(params, IgorBuilder.newObject(objType, \"\"), IgorBuilder),\n          obj = _IgorCore$metaDefines2[0],\n          cmds = _IgorCore$metaDefines2[1];\n\n      if (IgorCore.object_tickers[objType]) {\n        IgorCore.tick_entities.push(obj);\n      }\n\n      return obj.$_id;\n    } else {\n      console.warn(\"cannot find object type\");\n      debugger;\n      return false;\n    }\n  },\n  addNewObject: function addNewObject(target, objType, params) {\n    var def = IgorCore.metaDefines[objType];\n\n    if (def) {\n      var _def$new = def.new(params, IgorBuilder.newObject(objType, \"\", target.$_id), IgorBuilder),\n          obj = _def$new[0],\n          cmds = _def$new[1];\n\n      target.push(obj.$_id);\n\n      if (IgorCore.object_tickers[objType]) {\n        IgorCore.tick_entities.push(obj);\n      }\n\n      if (def._signal) IgorCore.graphics.signaler.signal(def._signal);\n      return true;\n    } else {\n      console.warn(\"cannot find object type\");\n      debugger;\n      return false;\n    }\n  },\n  deleteObject: function deleteObject(target) {\n    if (typeof target == \"string\" && target.includes(\"id\")) target = IgorCore.objs.get(target);\n    var def = IgorCore.metaDefines[target.$_type];\n    var del = def._delete;\n    del && del(target, IgorRunner);\n    var idx = IgorCore.tick_entities.findIndex(function (x) {\n      return x.$_id == target.$_id;\n    });\n    IgorCore.tick_entities.splice(idx, 1);\n    IgorCore.objs.delete(target.$_id);\n    IgorRunner.view.clearShowing();\n    def._signal && IgorCore.graphics.signaler.signal(def._signal);\n  }\n};\nwindow.IgorCore = IgorCore;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiN2pEYi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9JZ29ySnMvbWFpbi5qcz9lZTMwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBUaWNrZXIgZnJvbSBcInRpY2tlclwiXHJcbmltcG9ydCB7c2V0IGFzIGRiU2V0LCBnZXQgYXMgZGJHZXQsIGRlbCBhcyBkYkRlbCwgY2xlYXIgYXMgZGJDbGVhciwga2V5cyBhcyBkYktleXMsIFN0b3JlIGFzIGRiU3RvcmUsIFN0b3JlfSBmcm9tICdpZGIta2V5dmFsJ1xyXG5pbXBvcnQgS1ZTTWFwIGZyb20gXCJyZXNvdXJjZXMvdHlwZXMvS1ZTTWFwXCJcclxuaW1wb3J0IHtUYWdNYXBQcm94eX0gZnJvbSBcInJlc291cmNlcy90eXBlcy9UYWdzUHJveHlcIlxyXG5cclxuY29uc3QgSWdvckNvcmUgPSB7XHJcbiAgdGlja19lbnRpdGllczogW10sXHJcbiAgb2JqZWN0X3RpY2tlcnM6IHt9LFxyXG4gIGdhbWU6IHt9LCAvLyBUaXMgdGhlIGJhc2UgZ2FtZSBqc29uXHJcbiAgb2JqczogbmV3IE1hcCgpLFxyXG4gIG5hbWVkT2JqczogW10sXHJcbiAgJF90YWdzOiBuZXcgS1ZTTWFwKCksXHJcbiAgbWV0YToge30sIC8vIENvbnRhaW5zIGFsbCB0aGUgcnVudGltZSBkYXRhXHJcbiAgb3BzOiB7fSxcclxuICBzdGF0aWNzOiB7fSxcclxuICBjb250cm9sOiB7XHJcbiAgICBvYmpfY291bnRlcjogMFxyXG4gIH0sXHJcbiAgbWV0YURlZmluZXM6IHsgLy8gQXMgbWV0YSwgYnV0IG9yZ2FuaXplZCBieSBvYmplY3QgdHlwZXMgYW5kIGRpcmVjdCBwYXRoc1xyXG4gIH0sXHJcbiAgVGljazogKHRkKSA9PiB7XHJcbiAgICBmb3IoIGxldCBlYWNoIG9mIElnb3JDb3JlLnRpY2tfZW50aXRpZXMudmFsdWVzKCkpIHtcclxuICAgICAgaWYoIWVhY2guX3RhZ3MudGljaykgY29udGludWVcclxuICAgICAgbGV0IG9yZGVyID0gSWdvckNvcmUub2JqZWN0X3RpY2tlcnNbZWFjaC4kX3R5cGVdLiRfc2lnbmFsT3JkZXJzXHJcbiAgICAgIGlmKG9yZGVyKSB7XHJcbiAgICAgICAgb3JkZXIuZm9yRWFjaCggKHgpID0+IHtcclxuICAgICAgICAgIGlmKGVhY2guX3RhZ3NbeF0pIElnb3JDb3JlLm9iamVjdF90aWNrZXJzW2VhY2guJF90eXBlXVt4XS5mbihlYWNoLCB0ZCwgSWdvclJ1bm5lcilcclxuICAgICAgICB9KVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIElnb3JDb3JlLm9iamVjdF90aWNrZXJzW2VhY2guJF90eXBlXS50aWNrLmZuKGVhY2gsIHRkLCBJZ29yUnVubmVyKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBUaWNrX0J1aWxkZXI6ICh0ZCkgPT4ge1xyXG4gICAgbGV0IHJldCAgPSB7fVxyXG4gICAgT2JqZWN0LmFzc2lnbihyZXQsIHRkKVxyXG4gICAgLy8gTG9va3VwIHRpY2sgZGF0YSBzaWduYXR1cmVcclxuICAgIC8vICBleGVjdXRlIGNhbGxiYWNrcyB0byBhY3F1aXJlIGRhdGFcclxuICAgIHJldHVybiByZXRcclxuICB9LFxyXG4gIElnb3JCdWlsZGVyLFxyXG4gIGNvbmZpZzoge31cclxufVxyXG5cclxuLy8qIElnb3JCdWlsZGVyIHNob3VsZCBvbmx5IGNhbGxlZC9hY2Nlc3NlZCBmcm9tIHdpdGhpblxyXG4vLyAgdGhlIElnb3Igc2NvcGUsIGl0J3MgaW50ZXJuYWxseSB1c2VkIGJ5IHRoZSBJZ29yIEVuZ2luZVxyXG4vLyAgdG8gbWFuaXB1bGF0ZSB0aGUgbGlmZWN5Y2xlIG9mIGl0J3Mgb2JqZWN0c1xyXG5jb25zdCBJZ29yQnVpbGRlciA9IHtcclxuICBnZXQgZGF0YSgpIHsgcmV0dXJuIElnb3JDb3JlLmRhdGEgfSxcclxuICBnZXROYW1lZE9iamVjdCh3aGF0KSB7XHJcbiAgICByZXR1cm4gSWdvckNvcmUubmFtZWRPYmpzW3doYXRdXHJcbiAgfSxcclxuICBuZXdPYmplY3QodHlwZSwgc3ViVHlwZSwgcGFyZW50KSB7XHJcbiAgICBsZXQgb2JqID0ge1xyXG4gICAgICAkX2lkOiBcImlkX1wiK0lnb3JDb3JlLmNvbnRyb2wub2JqX2NvdW50ZXIrKyxcclxuICAgICAgJF90eXBlOiB0eXBlLFxyXG4gICAgICAkX3N1YlR5cGU6IHN1YlR5cGUsXHJcbiAgICAgICRfcGFyZW50OiBwYXJlbnQ/LiRfaWQgfHwgcGFyZW50XHJcbiAgICB9XHJcbiAgICBvYmouJF90YWdzID0gVGFnTWFwUHJveHkoe3RvOiBJZ29yQ29yZS4kX3RhZ3MsIGVudGl0eTogb2JqfSlcclxuICAgIElnb3JDb3JlLm9ianMuc2V0KG9iai4kX2lkLCBvYmopXHJcbiAgICByZXR1cm4gb2JqXHJcbiAgfSxcclxuICBuZXdDb21wb25lbnQ6IChvYmpUeXBlLCBwYXJhbXMsIHBhcmVudCApID0+IHtcclxuICAgIGlmKElnb3JDb3JlLm1ldGFEZWZpbmVzW29ialR5cGVdKSB7XHJcbiAgICAgIGxldCBbb2JqLCBjbWRzXSA9IElnb3JDb3JlLm1ldGFEZWZpbmVzW29ialR5cGVdLm5ldyhwYXJhbXMsIElnb3JCdWlsZGVyLm5ld09iamVjdChvYmpUeXBlLCBcIlwiLCBwYXJlbnQpLCBJZ29yQnVpbGRlcilcclxuICAgICAgaWYoSWdvckNvcmUub2JqZWN0X3RpY2tlcnNbb2JqVHlwZV0pIHtcclxuICAgICAgICBJZ29yQ29yZS50aWNrX2VudGl0aWVzLnB1c2gob2JqKVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBvYmouJF9pZFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiY2Fubm90IGZpbmQgb2JqZWN0IHR5cGVcIilcclxuICAgICAgZGVidWdnZXJcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IElnb3JVdGlscyA9IHtcclxuICBpbml0aWFsaXplKG9iaikge1xyXG4gICAgSWdvckNvcmUuZ3JhcGhpY3MgPSBvYmoudmlld1Rhc2tlclxyXG4gICAgSWdvckNvcmUuY29tbWFuZCA9IG9iai5jb21tYW5kVGFza2VyXHJcbiAgICBJZ29yQ29yZS50aWNrZXIgPSBuZXcgVGlja2VyKG9iai50aWNrZXIudGlja3NfcGVyU2VjLCBvYmoudGlja2VyLnRpY2tzX21heFBoYXNlLCBJZ29yQ29yZS5ncmFwaGljcy5zaWduYWxlcilcclxuICAgIElnb3JDb3JlLmNvbmZpZy5USUNLU19QRVJfU0VDT05EID0gb2JqLnRpY2tlci50aWNrc19wZXJTZWNcclxuICAgIElnb3JDb3JlLnN0YXRpY3NbXCJjb25maWcuVElDS1NfUEVSX1NFQ09ORFwiXSA9IG9iai50aWNrZXIudGlja3NfcGVyU2VjXHJcbiAgICBJZ29yVXRpbHMuVGlja2VyID0gSWdvckNvcmUudGlja2VyXHJcbiAgICBJZ29yQ29yZS50aWNrZXJfc3ViID0gSWdvckNvcmUudGlja2VyLnN1YnNjcmliZShJZ29yQ29yZS5UaWNrKVxyXG4gICAgSWdvckNvcmUuZGJOYW1lID0gb2JqLmRiTmFtZVxyXG4gICAgSWdvckNvcmUuc2F2ZU5hbWUgPSBvYmouc2F2ZU5hbWVcclxuICAgIElnb3JDb3JlLmRiID0gbmV3IFN0b3JlKElnb3JDb3JlLmRiTmFtZSwgXCJzdG9yZVwiKVxyXG4gICAgaWYoSWdvckNvcmUuX3Byb3ZpZGVUZW1wKSB7XHJcbiAgICAgIElnb3JDb3JlLl9wcm92aWRlVGVtcC5mb3JFYWNoKCAoZWxtKSA9PiB7SWdvckNvcmUuY29tbWFuZC5wcm92aWRlKGVsbS5pdGVtLCBlbG0uZm4sIGVsbS5zaWcsIGVsbS52YWxpZCl9KVxyXG4gICAgfVxyXG4gICAgaWYoSWdvckNvcmUuX3V0aWxpdHlUZW1wKSB7XHJcbiAgICAgIElnb3JDb3JlLl91dGlsaXR5VGVtcC5mb3JFYWNoKCAoZWxtKSA9PiBJZ29yQ29yZS5jb21tYW5kLnV0aWxpdHlGbihlbG0ubmFtZWQsIGVsbS5mbikgKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgcHJvdmlkZV9DQ0M6IChpdGVtLCBmbiwgc2lnLCB2YWxpZCkgPT4ge1xyXG4gICAgLy8hIFByb3ZpZGVzIHRlbXBvcmFyeSBwYXNzdGhyb3VnaCBmb3IgZ2FtZSBjb21tYW5kc1xyXG4gICAgLy8gICAgc28gZ2FtZSBhY3Rpb24gZGVmaW5pdGlvbnMgd29uJ3QgcmVmZXJlbmNlIENlcGhsYUNvbW0gZGlyZWN0bHlcclxuICAgIGlmKCFJZ29yQ29yZS5jb21tYW5kKSB7XHJcbiAgICAgIElnb3JDb3JlLl9wcm92aWRlVGVtcCB8fCAoSWdvckNvcmUuX3Byb3ZpZGVUZW1wID0gW10pXHJcbiAgICAgIElnb3JDb3JlLl9wcm92aWRlVGVtcC5wdXNoKHtpdGVtLCBmbiwgc2lnLCB2YWxpZH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBJZ29yQ29yZS5jb21tYW5kLnByb3ZpZGUoaXRlbSwgZm4sIHNpZywgdmFsaWQpXHJcbiAgICB9XHJcbiAgfSxcclxuICBDQ0NfYWRkVXRpbGl0eTogKG5hbWVkLCBmbikgPT4ge1xyXG4gICAgaWYoIUlnb3JDb3JlLmNvbW1hbmQpIHtcclxuICAgICAgSWdvckNvcmUuX3V0aWxpdHlUZW1wIHx8IChJZ29yQ29yZS5fdXRpbGl0eVRlbXAgPSBbXSlcclxuICAgICAgSWdvckNvcmUuX3V0aWxpdHlUZW1wLnB1c2goe25hbWVkLCBmbn0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBJZ29yQ29yZS5jb21tYW5kLnV0aWxpdHlGbihuYW1lZCwgZm4pXHJcbiAgICB9XHJcbiAgfSxcclxuICBkZWZpbmVPYmo6ICh3aG8sIGZuLCBhY3Rpb25zKSA9PiB7XHJcbiAgICBJZ29yQ29yZS5tZXRhRGVmaW5lc1t3aG9dID0ge1xyXG4gICAgICBuZXc6IGZuLFxyXG4gICAgICBfZGVsZXRlOiBmbi5fZGVsZXRlLFxyXG4gICAgICBfc2lnbmFsOiBmbi5fc2lnbmFsLFxyXG4gICAgICBhY3Rpb25zLFxyXG4gICAgfVxyXG4gICAgaWYoYWN0aW9ucz8udGljayl7XHJcbiAgICAgICFJZ29yQ29yZS5vYmplY3RfdGlja2Vyc1t3aG9dICYmIChJZ29yQ29yZS5vYmplY3RfdGlja2Vyc1t3aG9dID0ge30pXHJcbiAgICAgIElnb3JDb3JlLm9iamVjdF90aWNrZXJzW3dob10udGljayA9IHtcclxuICAgICAgICB0eXBlOiB3aG8sXHJcbiAgICAgICAgZm46IGFjdGlvbnMudGlja1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBhY3Rpb25zICYmIE9iamVjdC5lbnRyaWVzKGFjdGlvbnMpLmZvckVhY2goKFtwcm9wLCBvYmpdKSA9PiB7XHJcbiAgICAgIGlmKG9iaiAmJiBvYmouQ0NfcHJvdmlkZSkgSWdvclV0aWxzLnByb3ZpZGVfQ0NDKG9iai5DQ19wcm92aWRlLCBvYmosIG9iai5zaWduYXR1cmUsIG9iai52YWxpZGF0b3IpXHJcbiAgICAgIGlmKG9iaiAmJiBvYmouSWdvcl9vcGVyYXRpb24pIElnb3JVdGlscy5hZGRPcGVyYXRpb24ob2JqLklnb3Jfb3BlcmF0aW9uLCBvYmopXHJcbiAgICAgIGlmKG9iaiAmJiBvYmouQ0NfdXRpbGl0eSkgSWdvclV0aWxzLkNDQ19hZGRVdGlsaXR5KG9iai5DQ191dGlsaXR5LCBvYmopXHJcbiAgICB9KVxyXG4gIFxyXG4gIH0sXHJcbiAgc2V0U3RhdGljOiAobmFtZSwgYXMpID0+IHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJZ29yQ29yZS5zdGF0aWNzLCBuYW1lLCB7XHJcbiAgICAgIHZhbHVlOiBhcyxcclxuICAgICAgd3JpdGFibGU6IGZhbHNlXHJcbiAgICB9KVxyXG4gIH0sXHJcbiAgYWRkT3BlcmF0aW9uOiAob3AsIGZuKSA9PiB7XHJcbiAgICAvLyogVGhlc2UgZnVuY3Rpb25zIGFyZSBvbmx5IGFjY2Vzc2libGUgZnJvbSBnYW1lIGNvZGVzXHJcbiAgICAvLyBUaGVpciBzaWduYXR1cmUgc2hvdWxkbid0IG5lZWQgdG8gYmUga25vd25cclxuICAgIElnb3JDb3JlLm9wc1tvcF0gPSB7Zm59XHJcbiAgfSxcclxuICAvLyEgSSBkb24ndCByZWFsbHkgbGlrZSB0aGlzIGltcGxlbWVudGF0aW9uXHJcbiAgLy8gSSBuZWVkIGEgd2F5IHRvIHByb3ZpZGUgZGlmZmVyZW50IHRpY2sgcHJvY2Vzc29ycyBmb3IgZGlmZmVyZW50IHRhZ3NcclxuICAvLyB0aWNrRGF0YVNpZyB3b3VsZCBiZSB0aGUgbmVlZGVkIHBhcmFtZXRlcnMgZnJvbSB0aGUgcGFzc2VkIFRpY2tEYXRhXHJcbiAgYWRkT2JqZWN0VGlja0hhbmRsZXI6ICh3aG8sIHdoYXQsIG5hbWVkLCBwcmlvcml0eSkgPT4ge1xyXG4gICAgIUlnb3JDb3JlLm9iamVjdF90aWNrZXJzW3dob10gJiYgKElnb3JDb3JlLm9iamVjdF90aWNrZXJzW3dob10gID0ge30pXHJcblxyXG4gICAgbGV0IGF0ID0gSWdvckNvcmUub2JqZWN0X3RpY2tlcnNbd2hvXVxyXG4gICAgYXRbbmFtZWRdID0ge1xyXG4gICAgICB0eXBlOiB3aG8sXHJcbiAgICAgIGZuOiB3aGF0LFxyXG4gICAgICBwcmlvcml0eVxyXG4gICAgfVxyXG4gICAgLy9SZWdlbmVyYXRlIHByaW9yaXRpZXMuLi4gYWRkIHRvIGJhc2Ugb2JqZWN0X3RpY2tlcnNcclxuICAgIGxldCBvcmRlciA9IGF0LiRfc2lnbmFsT3JkZXJzIHx8IFtcInRpY2tcIl1cclxuICAgIGxldCB0aWNrSWR4ID0gb3JkZXIuZmluZEluZGV4KCh4KT0+IHg9PVwidGlja1wiKVxyXG4gICAgaWYocHJpb3JpdHkuY2hhaW4pIHtcclxuICAgICAgLy8hIExvdHMgbW9yZSBuZWVkZWQgZm9yIHRoaXMuLi5cclxuICAgICAgLy8gbmVlZCB0byBhY2NvdW50IGZvciBwcmlvcml0aWVzXHJcbiAgICAgIFtdLnNwbGljZS5hcHBseShvcmRlciwgW3RpY2tJZHgsIDFdLmNvbmNhdChwcmlvcml0eS5jaGFpbikpXHJcbiAgICB9IGVsc2UgaWYocHJpb3JpdHkubnVtKSB7XHJcbiAgICAgIC8vLi4uIGFsc28gaWYgbm8gY2hhaW4gZXhpc3RzLi4uXHJcbiAgICB9XHJcbiAgICBhdC4kX3NpZ25hbE9yZGVycyA9IG9yZGVyXHJcbiAgfSxcclxuICBhc3luYyBsb2FkRGF0YWJhc2UoZGF0YXNldCkge1xyXG4gICAgSWdvckNvcmUuZGF0YSA9IGRhdGFzZXRcclxuICAgIC8vSXRlcmF0ZSB0aHJvdWdoIGRhdGEgb2JqZWN0c1xyXG4gICAgLy8gcGFzcyByZXF1aXJlZCBpbmZvIGludG8gR3JhcGhpY3MgYW5kIENvbW1hbmQgcHJvY2Vzc29yc1xyXG4gICAgXHJcbiAgICAvL0lmIHNhdmUgbG9hZGVkLFxyXG4gICAgSWdvckNvcmUuc2F2ZSA9IGF3YWl0IGRiR2V0KElnb3JDb3JlLnNhdmVOYW1lLCBJZ29yQ29yZS5kYilcclxuICAgIGlmKElnb3JDb3JlLnNhdmUpIHtcclxuICAgICAgSWdvckNvcmUuZ2FtZSA9IEpTT04ucGFyc2UoSWdvckNvcmUuc2F2ZS5nYW1lKVxyXG4gICAgICBJZ29yQ29yZS5vYmpzID0gbmV3IE1hcChKU09OLnBhcnNlKElnb3JDb3JlLnNhdmUub2JqcykpXHJcbiAgICAgIGlmKElnb3JDb3JlLnNhdmUuY29udHJvbCkgSWdvckNvcmUuY29udHJvbCA9IEpTT04ucGFyc2UoSWdvckNvcmUuc2F2ZS5jb250cm9sKVxyXG4gICAgICAvL1JlY29ubmVjdCB0YWdzXHJcbiAgICAgIElnb3JDb3JlLm9ianMuZm9yRWFjaCggKHgpID0+IHtcclxuICAgICAgICB4LiRfdGFncyA9IFRhZ01hcFByb3h5KHt0bzogSWdvckNvcmUuJF90YWdzLCBlbnRpdHk6IHgsIGxvYWQ6IHguJF90YWdzfSlcclxuICAgICAgICBpZihJZ29yQ29yZS5vYmplY3RfdGlja2Vyc1t4LiRfdHlwZV0pIElnb3JDb3JlLnRpY2tfZW50aXRpZXMucHVzaCh4KVxyXG4gICAgICB9KVxyXG4gICAgICAvL2NvbnNvbGUubG9nKCdmb3VuZCBzYXZlJylcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vQ3JlYXRlIG5ldyBnYW1lXHJcbiAgICAgIElnb3JDb3JlLmdhbWUgPSBJZ29yQ29yZS5tZXRhRGVmaW5lc1snIyddLm5ld1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCduZXcgZ2FtZScpXHJcbiAgICB9XHJcbiAgICAvL2NvbnNvbGUubG9nKCdkYiBsb2FkZWQnKVxyXG4gIH0sXHJcbiAgc2V0TmFtZWQoYXMsIHdobykge1xyXG4gICAgSWdvckNvcmUubmFtZWRPYmpzW2FzXSA9IHdob1xyXG4gIH0sXHJcbiAgZ2V0T2JqSWQoaWQsIGRvdWJsZVByb3ApIHtcclxuICAgIGlmKCFkb3VibGVQcm9wKSByZXR1cm4gSWdvckNvcmUub2Jqcy5nZXQoaWQpXHJcbiAgICBsZXQgb2JqID0gSWdvckNvcmUub2Jqcy5nZXQoaWQpXHJcbiAgICBvYmogPSBPYmplY3Qud2Fsa1BhdGgob2JqLCBkb3VibGVQcm9wKVxyXG4gICAgcmV0dXJuIElnb3JDb3JlLm9ianMuZ2V0KG9iailcclxuICB9LFxyXG4gIGFycmF5RnJvbUlkcyhsaXN0KSB7XHJcbiAgICBpZighbGlzdCkgcmV0dXJuIFtdXHJcbiAgICBsZXQgcmV0ID0gW11cclxuICAgIGxpc3QuZm9yRWFjaCggKGlkKSA9PiB7IHJldC5wdXNoKElnb3JDb3JlLm9ianMuZ2V0KGlkKSkgfSlcclxuICAgIHJldHVybiByZXRcclxuICB9LFxyXG4gIGdldFJ1bm5lcigpIHsgcmV0dXJuIElnb3JSdW5uZXIgfSxcclxuICBnZXQgZ2xvYmFsT2JqZWN0KCkge1xyXG4gICAgcmV0dXJuIElnb3JDb3JlLmdhbWVcclxuICB9LFxyXG4gIGdldCBkYXRhU2V0KCkge1xyXG4gICAgcmV0dXJuIElnb3JDb3JlLmRhdGFcclxuICB9LFxyXG4gIGdldChuYW1lZCwgc3BlY2lmaWVycykge1xyXG4gICAgcmV0dXJuIElnb3JDb3JlLm9iamVjdHNfYnlfbmFtZSgpXHJcbiAgfSxcclxuICBzYXZlR2FtZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiR2FtZSBzYXZpbmcuLi5cIilcclxuICAgIGxldCBkYXRhID0ge1xyXG4gICAgICBnYW1lOiBKU09OLnN0cmluZ2lmeShJZ29yQ29yZS5nYW1lKSxcclxuICAgICAgb2JqczogSlNPTi5zdHJpbmdpZnkoQXJyYXkuZnJvbShJZ29yQ29yZS5vYmpzLmVudHJpZXMoKSkpLFxyXG4gICAgICBjb250cm9sOiBKU09OLnN0cmluZ2lmeShJZ29yQ29yZS5jb250cm9sKVxyXG4gICAgfVxyXG4gICAgZGJTZXQoSWdvckNvcmUuc2F2ZU5hbWUsIGRhdGEsIElnb3JDb3JlLmRiKVxyXG4gIH0sXHJcbiAgYmFja3VwU2F2ZSgpIHtcclxuICAgIGxldCBkYXRhID0ge1xyXG4gICAgICBnYW1lOiBKU09OLnN0cmluZ2lmeShJZ29yQ29yZS5nYW1lKSxcclxuICAgICAgb2JqczogSlNPTi5zdHJpbmdpZnkoQXJyYXkuZnJvbShJZ29yQ29yZS5vYmpzLmVudHJpZXMoKSkpXHJcbiAgICB9XHJcbiAgICBkYlNldChcIlNhdmVHYW1lX2Jha1wiLCBkYXRhLCBJZ29yQ29yZS5kYilcclxuICB9LFxyXG4gIGFzeW5jIGxvYWRCYWNrdXAoKSB7XHJcbiAgICBsZXQgc2F2ZSA9IGF3YWl0IGRiR2V0KFwiU2F2ZUdhbWVfYmFrXCIsIElnb3JDb3JlLmRiKVxyXG4gICAgSWdvckNvcmUuZ2FtZSA9IEpTT04ucGFyc2Uoc2F2ZS5nYW1lKVxyXG4gICAgSWdvckNvcmUub2JqcyA9IG5ldyBNYXAoSlNPTi5wYXJzZShzYXZlLm9ianMpKVxyXG4gICAgSWdvckNvcmUub2Jqcy5mb3JFYWNoKCAoeCkgPT4ge1xyXG4gICAgICB4LiRfdGFncyA9IFRhZ01hcFByb3h5KHt0bzogSWdvckNvcmUuJF90YWdzLCBlbnRpdHk6eCwgbG9hZDogeC4kX3RhZ3N9KVxyXG4gICAgICBpZihJZ29yQ29yZS5vYmplY3RfdGlja2Vyc1t4LiRfdHlwZV0pIElnb3JDb3JlLnRpY2tfZW50aXRpZXMucHVzaCh4KVxyXG4gICAgfSlcclxuICAgIGNvbnNvbGUubG9nKFwiYmFja3VwIGxvYWRlZFwiKVxyXG4gIH0sXHJcbiAgc2V0U3RhdGUod2hpY2gpIHtcclxuICAgIHN3aXRjaCh3aGljaCkge1xyXG4gICAgICBjYXNlIFwic3RhcnRcIjpcclxuICAgICAgICBJZ29yQ29yZS5ncmFwaGljcy5zaWduYWxlci5zaWduYWwoXCJnZW5lcmFsVXBkYXRlXCIpXHJcbiAgICAgICAgSWdvckNvcmUuZ3JhcGhpY3Muc2lnbmFsZXIuc2lnbmFsKFwiZW50aXR5VXBkYXRlXCIpXHJcbiAgICAgICAgSWdvckNvcmUuZ3JhcGhpY3Muc2lnbmFsZXIuc2lnbmFsKFwidGVjaFJlc2VhcmNoZWRcIilcclxuICAgICAgICBJZ29yQ29yZS50aWNrZXIucmVzdW1lKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJzdG9wXCI6XHJcbiAgICAgICAgSWdvckNvcmUudGlja2VyLnBhdXNlKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJ0aWNrXCI6XHJcbiAgICAgICAgSWdvckNvcmUudGlja2VyLm9uY2UoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcInRvZ2dsZVwiOlxyXG4gICAgICAgIElnb3JDb3JlLnRpY2tlci50b2dnbGUoKTtcclxuICAgICAgICBpZihJZ29yQ29yZS50aWNrZXIuaXNSdW5uaW5nKSB7XHJcbiAgICAgICAgICBJZ29yQ29yZS5ncmFwaGljcy5zaWduYWxlci5zaWduYWwoXCJnZW5lcmFsVXBkYXRlXCIpXHJcbiAgICAgICAgICBJZ29yQ29yZS5ncmFwaGljcy5zaWduYWxlci5zaWduYWwoXCJlbnRpdHlVcGRhdGVcIilcclxuICAgICAgICAgIElnb3JDb3JlLmdyYXBoaWNzLnNpZ25hbGVyLnNpZ25hbChcInRlY2hSZXNlYXJjaGVkXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGNvbnNvbGUud2FybihcIklHT1I6IHNldHRpbmcgdW5rbm93biBzdGF0ZVwiKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgYXN5bmMgY29tbWFuZHMod2hhdCwgcGFyYW1zKSB7XHJcbiAgICBzd2l0Y2god2hhdCkge1xyXG4gICAgICBjYXNlIFwicmVzZXRTYXZlXCI6XHJcbiAgICAgICAgYXdhaXQgZGJEZWwoSWdvckNvcmUuc2F2ZU5hbWUsIElnb3JDb3JlLmRiKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICBjYXNlIFwiY29weVNhdmVcIjpcclxuICAgICAgICB3aW5kb3cudGZtZ19zYXZlID0gYXdhaXQgZGJHZXQoSWdvckNvcmUuc2F2ZU5hbWUsIElnb3JDb3JlLmRiKVxyXG4gICAgICAgIHJldHVybiBcImRvbmVcIjtcclxuICAgICAgY2FzZSBcInN0b3JlU2F2ZVwiOlxyXG4gICAgICAgIGF3YWl0IGRiU2V0KElnb3JDb3JlLnNhdmVOYW1lLCBwYXJhbXMsIElnb3JDb3JlLmRiKTtcclxuICAgICAgICByZXR1cm4gXCJkb25lXCI7XHJcbiAgICAgIGNhc2UgXCJiYWNrdXBTYXZlXCI6XHJcbiAgICAgICAgSWdvclV0aWxzLmJhY2t1cFNhdmUoKVxyXG4gICAgICAgIHJldHVybiBcImRvbmVcIlxyXG4gICAgICBjYXNlIFwicmVzdG9yZUJhY2t1cFNhdmVcIjpcclxuICAgICAgICBsZXQgc2F2ZSA9IGF3YWl0IGRiR2V0KFwiU2F2ZUdhbWVfYmFrXCIsIElnb3JDb3JlLmRiKVxyXG4gICAgICAgIGRiU2V0KElnb3JDb3JlLnNhdmVOYW1lLCBzYXZlLCBJZ29yQ29yZS5kYilcclxuICAgICAgICByZXR1cm4gXCJkb25lXCJcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcblxyXG4vLyAgVGhlIHB1cnBvc2Ugb2YgSWdvclJ1bm5lciBpcyB0byBhY2NlcHQgY29tbWFuZHMgZnJvbSBleHRlcm5hbCBzb3VyY2VzLCBhbmQgcHJvY2VzcyB0aGVtIGludG8gdGhlXHJcbi8vICBJZ29yIGVudmlyb25tZW50XHJcbi8vVGhlIElnb3JSdW5uZXIgaXMgcGFzc2VkIHRvIEdhbWVPYmplY3RBY3Rpb25GdW5jdGlvbnMgc28gdGhleSBtYXkgZW1pdCBldmVudHMgb3IgZ2V0IGRhdGFcclxuZXhwb3J0IGNvbnN0IElnb3JSdW5uZXIgPSB7XHJcbiAgZW1pdDogKCkgPT4ge1xyXG4gICAgLy9JIGVtaXQgZXZlbnRzIGludG8gSWdvclxyXG4gIH0sXHJcbiAgZ2V0IGRhdGEoKSB7IHJldHVybiBJZ29yQ29yZS5kYXRhIH0sXHJcbiAgZ2V0IHZpZXcoKSB7IHJldHVybiBJZ29yQ29yZS5ncmFwaGljcyB9LFxyXG4gIGdldCBjb25maWcoKSB7IHJldHVybiBJZ29yQ29yZS5jb25maWcgfSxcclxuICBwcm9jZXNzVEVNUDogKG9iaiwgb3AsIGFyZ3MpID0+IHtcclxuICAgIGxldCByZXQgPSB7fVxyXG4gICAgaWYodHlwZW9mIG9iaiA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGlmKG9iai5pbmNsdWRlcyhcImlkXCIpKSB7XHJcbiAgICAgICAgb2JqID0gSWdvckNvcmUub2Jqcy5nZXQob2JqKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCB0ZW1wID0gSWdvckNvcmUubmFtZWRPYmpzW29ial1cclxuICAgICAgICBpZih0ZW1wKSBvYmogPSB0ZW1wXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIElnb3JDb3JlLm9wc1tvcF0uZm4ob2JqLCBhcmdzLCByZXQsIElnb3JSdW5uZXIsIElnb3JDb3JlLm9wc1tvcF0uZm4pXHJcbiAgICAvL2NvbnNvbGUubG9nKCdfcmVzdWx0JyBpbiByZXQpXHJcbiAgICByZXR1cm4gJ19yZXN1bHQnIGluIHJldCA/IHJldC5fcmVzdWx0IDogcmV0XHJcbiAgfSxcclxuICBnZXROYW1lZE9iamVjdDogKHdoYXQpID0+IHtcclxuICAgIHJldHVybiBJZ29yQ29yZS5uYW1lZE9ianNbd2hhdF1cclxuICB9LFxyXG4gIGdldElkOiAod2hpY2gsIGRvdWJsZVByb3ApID0+IHtcclxuICAgIGlmKCFkb3VibGVQcm9wKSByZXR1cm4gSWdvckNvcmUub2Jqcy5nZXQod2hpY2gpXHJcbiAgICBsZXQgb2JqID0gSWdvckNvcmUub2Jqcy5nZXQod2hpY2gpXHJcbiAgICBvYmogPSBPYmplY3Qud2Fsa1BhdGgob2JqLCBkb3VibGVQcm9wKVxyXG4gICAgcmV0dXJuIElnb3JDb3JlLm9ianMuZ2V0KG9iailcclxuICB9LFxyXG4gIGdldFN0YXRpYzogKHdoaWNoKSA9PiB7XHJcbiAgICByZXR1cm4gSWdvckNvcmUuc3RhdGljc1t3aGljaF1cclxuICB9LFxyXG4gIHVwZGF0ZVN0YXRpYzogKHdoaWNoLCBpcykgPT4ge1xyXG4gICAgSWdvckNvcmUuc3RhdGljc1t3aGljaF0gPSBpc1xyXG4gIH0sXHJcbiAgbmV3Q29tcG9uZW50OiAob2JqVHlwZSwgcGFyYW1zICkgPT4ge1xyXG4gICAgaWYoSWdvckNvcmUubWV0YURlZmluZXNbb2JqVHlwZV0pIHtcclxuICAgICAgbGV0IFtvYmosIGNtZHNdID0gSWdvckNvcmUubWV0YURlZmluZXNbb2JqVHlwZV0ubmV3KHBhcmFtcywgSWdvckJ1aWxkZXIubmV3T2JqZWN0KG9ialR5cGUsIFwiXCIpLCBJZ29yQnVpbGRlcilcclxuICAgICAgaWYoSWdvckNvcmUub2JqZWN0X3RpY2tlcnNbb2JqVHlwZV0pIHtcclxuICAgICAgICBJZ29yQ29yZS50aWNrX2VudGl0aWVzLnB1c2gob2JqKVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBvYmouJF9pZFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiY2Fubm90IGZpbmQgb2JqZWN0IHR5cGVcIilcclxuICAgICAgZGVidWdnZXJcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgfSxcclxuICBhZGROZXdPYmplY3Q6ICh0YXJnZXQsIG9ialR5cGUsIHBhcmFtcyApID0+IHtcclxuICAgIGxldCBkZWYgPSBJZ29yQ29yZS5tZXRhRGVmaW5lc1tvYmpUeXBlXVxyXG4gICAgaWYoZGVmKSB7XHJcbiAgICAgIGxldCBbb2JqLCBjbWRzXSA9IGRlZi5uZXcocGFyYW1zLCBJZ29yQnVpbGRlci5uZXdPYmplY3Qob2JqVHlwZSwgXCJcIiwgdGFyZ2V0LiRfaWQpLCBJZ29yQnVpbGRlcilcclxuICAgICAgdGFyZ2V0LnB1c2gob2JqLiRfaWQpXHJcbiAgICAgIGlmKElnb3JDb3JlLm9iamVjdF90aWNrZXJzW29ialR5cGVdKSB7XHJcbiAgICAgICAgSWdvckNvcmUudGlja19lbnRpdGllcy5wdXNoKG9iailcclxuICAgICAgfVxyXG4gICAgICBpZihkZWYuX3NpZ25hbCkgSWdvckNvcmUuZ3JhcGhpY3Muc2lnbmFsZXIuc2lnbmFsKGRlZi5fc2lnbmFsKVxyXG4gICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiY2Fubm90IGZpbmQgb2JqZWN0IHR5cGVcIilcclxuICAgICAgZGVidWdnZXJcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgfSxcclxuICBkZWxldGVPYmplY3Q6ICh0YXJnZXQpID0+IHtcclxuICAgIGlmKHR5cGVvZiB0YXJnZXQ9PVwic3RyaW5nXCIgJiYgdGFyZ2V0LmluY2x1ZGVzKFwiaWRcIikpIHRhcmdldCA9IElnb3JDb3JlLm9ianMuZ2V0KHRhcmdldClcclxuICAgIGxldCBkZWYgPSBJZ29yQ29yZS5tZXRhRGVmaW5lc1t0YXJnZXQuJF90eXBlXVxyXG4gICAgbGV0IGRlbCA9IGRlZi5fZGVsZXRlXHJcbiAgICBkZWwgJiYgZGVsKHRhcmdldCwgSWdvclJ1bm5lcilcclxuICAgIGxldCBpZHggPSBJZ29yQ29yZS50aWNrX2VudGl0aWVzLmZpbmRJbmRleCggKHgpID0+IHsgcmV0dXJuIHguJF9pZD09dGFyZ2V0LiRfaWQgfSlcclxuICAgIElnb3JDb3JlLnRpY2tfZW50aXRpZXMuc3BsaWNlKGlkeCwgMSlcclxuICAgIElnb3JDb3JlLm9ianMuZGVsZXRlKHRhcmdldC4kX2lkKVxyXG4gICAgSWdvclJ1bm5lci52aWV3LmNsZWFyU2hvd2luZygpXHJcbiAgICBkZWYuX3NpZ25hbCAmJiBJZ29yQ29yZS5ncmFwaGljcy5zaWduYWxlci5zaWduYWwoZGVmLl9zaWduYWwpXHJcbiAgfVxyXG59XHJcblxyXG5cclxud2luZG93Lklnb3JDb3JlID0gSWdvckNvcmVcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQXBDQTtBQXdDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1QkE7QUFnQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBTkE7QUFBQTtBQUNBO0FBREE7QUFNQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUF2QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBdEJBO0FBd0JBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQU1BO0FBTkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFZQTtBQVpBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBZUE7QUFDQTtBQWhCQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFtQkE7QUFyTkE7QUEwTkE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBM0VBO0FBK0VBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///7jDb\n");

/***/ }),

/***/ "mUjK":
/*!************************!*\
  !*** ./src/IconMgr.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return IconMgr; });\nvar IconMgr = /*#__PURE__*/function () {\n  function IconMgr() {\n    this.iconList = {};\n  }\n\n  var _proto = IconMgr.prototype;\n\n  _proto.import = function _import(iconList) {\n    this.iconList = iconList;\n\n    for (var _i = 0, _Object$entries = Object.entries(this.iconList.tool); _i < _Object$entries.length; _i++) {\n      var _Object$entries$_i = _Object$entries[_i],\n          name = _Object$entries$_i[0],\n          obj = _Object$entries$_i[1];\n      this.iconList.item[name] = obj;\n    }\n  };\n\n  _proto.getSrc = function getSrc(type, name) {\n    if (!type) return \"\";\n\n    if (type.indexOf(\"@\") == -1) {\n      return this.iconList.item[type];\n    } else if (type.indexOf(\"@\") > -1 && !name) {\n      var _type$split = type.split(\"@\");\n\n      type = _type$split[0];\n      name = _type$split[1];\n    }\n\n    return this.iconList[type] && this.iconList[type][name] || this.iconList.item[name] || null;\n  };\n\n  return IconMgr;\n}();\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibVVqSy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9JY29uTWdyLmpzPzk5NDgiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSWNvbk1nciB7XHJcbiAgaWNvbkxpc3QgPSB7fVxyXG4gIGNvbnN0cnVjdG9yKCkge31cclxuICBpbXBvcnQoaWNvbkxpc3QpIHtcclxuICAgIHRoaXMuaWNvbkxpc3QgPSBpY29uTGlzdFxyXG4gICAgZm9yIChjb25zdCBbbmFtZSwgb2JqXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmljb25MaXN0LnRvb2wpKSB7XHJcbiAgICAgIHRoaXMuaWNvbkxpc3QuaXRlbVtuYW1lXSA9IG9ialxyXG4gICAgfVxyXG4gIH1cclxuICBnZXRTcmModHlwZSwgbmFtZSkge1xyXG4gICAgaWYgKCF0eXBlKSByZXR1cm4gXCJcIlxyXG4gICAgaWYodHlwZS5pbmRleE9mKFwiQFwiKT09LTEpIHtcclxuICAgICAgXHJcbiAgICAgIHJldHVybih0aGlzLmljb25MaXN0Lml0ZW1bdHlwZV0pXHJcbiAgICB9IGVsc2UgaWYgKHR5cGUuaW5kZXhPZihcIkBcIik+IC0xICYmICFuYW1lKSB7XHJcbiAgICAgIFt0eXBlLCBuYW1lXSA9IHR5cGUuc3BsaXQoXCJAXCIpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gKHRoaXMuaWNvbkxpc3RbdHlwZV0gJiYgdGhpcy5pY29uTGlzdFt0eXBlXVtuYW1lXSkgfHwgdGhpcy5pY29uTGlzdC5pdGVtW25hbWVdIHx8IG51bGxcclxuICB9XHJcbn1cclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7OzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///mUjK\n");

/***/ }),

/***/ "uShe":
/*!*****************************!*\
  !*** ./src/DataProvider.js ***!
  \*****************************/
/*! exports provided: DataProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataProvider\", function() { return DataProvider; });\n/* harmony import */ var managers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! managers */ \"+Aae\");\n/* harmony import */ var Config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! Config */ \"463H\");\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n\n\nvar mgrs = managers__WEBPACK_IMPORTED_MODULE_0__[\"mgrs\"];\nvar DataProvider = {\n  onLoadComplete: function onLoadComplete(cb) {\n    DataProvider.loadCb = cb;\n  },\n  beginLoad: function beginLoad() {\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var ds, url, resp, icons, save;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return mgrs.idb.get('last_ds');\n\n            case 2:\n              _context.t0 = _context.sent;\n              _context.t1 = Config__WEBPACK_IMPORTED_MODULE_1__[\"LAST_DS_DB\"];\n\n              if (!(_context.t0 != _context.t1)) {\n                _context.next = 16;\n                break;\n              }\n\n              //console.log(\"last datasource out of data\")\n              url = location.href.slice(0, location.href.lastIndexOf(\"/\"));\n              _context.next = 8;\n              return fetch(url + \"/data_source.json\");\n\n            case 8:\n              resp = _context.sent;\n              _context.next = 11;\n              return resp.json();\n\n            case 11:\n              ds = _context.sent;\n              mgrs.idb.set(\"last_ds\", Config__WEBPACK_IMPORTED_MODULE_1__[\"LAST_DS_DB\"]);\n              mgrs.idb.set(\"dataSet\", ds);\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.next = 18;\n              return mgrs.idb.get(\"dataSet\");\n\n            case 18:\n              ds = _context.sent;\n\n            case 19:\n              _context.next = 21;\n              return mgrs.idb.get(\"Icons\");\n\n            case 21:\n              icons = _context.sent;\n              icons && (ds.icons = icons);\n              _context.next = 25;\n              return mgrs.idb.get(\"SaveGame\");\n\n            case 25:\n              _context.t2 = _context.sent;\n\n              if (_context.t2) {\n                _context.next = 28;\n                break;\n              }\n\n              _context.t2 = null;\n\n            case 28:\n              save = _context.t2;\n\n              if (save) {\n                _context.next = 37;\n                break;\n              }\n\n              _context.next = 32;\n              return mgrs.idb.get(\"SaveGame_Igor\");\n\n            case 32:\n              _context.t3 = _context.sent;\n\n              if (_context.t3) {\n                _context.next = 35;\n                break;\n              }\n\n              _context.t3 = null;\n\n            case 35:\n              save = _context.t3;\n              if (save && !save.version) save.version = Config__WEBPACK_IMPORTED_MODULE_1__[\"IDB_SAVE_VERSION\"];\n\n            case 37:\n              DataProvider.init(ds, save);\n\n            case 38:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  init: function init(data, save) {\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              mgrs.icon.import(data.icons);\n              mgrs.item.import(data.item);\n              mgrs.rec.import(data.recipe, mgrs.item);\n              mgrs.data = data;\n              DataProvider.loadCb({\n                mgrs: mgrs,\n                save: save\n              });\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  saveGame: function saveGame(data) {\n    if (data) {\n      mgrs.idb.set(\"SaveGame\", data);\n    } else {\n      mgrs.idb.del(\"SaveGame\");\n      window.location.reload();\n    }\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidVNoZS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9EYXRhUHJvdmlkZXIuanM/YjkyOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge21ncnMgYXMgTUdSU30gZnJvbSAnbWFuYWdlcnMnXHJcbmltcG9ydCAqIGFzIENvbmZpZyBmcm9tICdDb25maWcnXHJcblxyXG52YXIgbWdycyA9IE1HUlNcclxuZXhwb3J0IGxldCBEYXRhUHJvdmlkZXIgPSB7XHJcbiAgb25Mb2FkQ29tcGxldGUoY2IpIHtcclxuICAgIERhdGFQcm92aWRlci5sb2FkQ2IgPSBjYlxyXG4gIH0sXHJcbiAgYXN5bmMgYmVnaW5Mb2FkKCkge1xyXG4gICAgbGV0IGRzXHJcbiAgICBpZihhd2FpdCBtZ3JzLmlkYi5nZXQoJ2xhc3RfZHMnKSE9Q29uZmlnLkxBU1RfRFNfREIpIHtcclxuICAgICAgLy9jb25zb2xlLmxvZyhcImxhc3QgZGF0YXNvdXJjZSBvdXQgb2YgZGF0YVwiKVxyXG4gICAgICBsZXQgdXJsID0gbG9jYXRpb24uaHJlZi5zbGljZSgwLCBsb2NhdGlvbi5ocmVmLmxhc3RJbmRleE9mKFwiL1wiKSlcclxuICAgICAgbGV0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwrXCIvZGF0YV9zb3VyY2UuanNvblwiKVxyXG4gICAgICBkcyA9IGF3YWl0IHJlc3AuanNvbigpXHJcbiAgICAgIG1ncnMuaWRiLnNldChcImxhc3RfZHNcIiwgQ29uZmlnLkxBU1RfRFNfREIpXHJcbiAgICAgIG1ncnMuaWRiLnNldChcImRhdGFTZXRcIiwgZHMpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdsYXN0IGRhdGFzb3VyY2UgdXAgdG8gZGF0ZScpXHJcbiAgICAgIGRzID0gYXdhaXQgbWdycy5pZGIuZ2V0KFwiZGF0YVNldFwiKVxyXG4gICAgfVxyXG4gICAgbGV0IGljb25zID0gYXdhaXQgbWdycy5pZGIuZ2V0KFwiSWNvbnNcIilcclxuICAgIGljb25zICYmIChkcy5pY29ucyA9IGljb25zKVxyXG4gICAgbGV0IHNhdmUgPSBhd2FpdCBtZ3JzLmlkYi5nZXQoXCJTYXZlR2FtZVwiKSB8fCBudWxsXHJcbiAgICBpZighc2F2ZSkge1xyXG4gICAgICBzYXZlID0gYXdhaXQgbWdycy5pZGIuZ2V0KFwiU2F2ZUdhbWVfSWdvclwiKSB8fCBudWxsXHJcbiAgICAgIGlmKHNhdmUgJiYgIXNhdmUudmVyc2lvbikgc2F2ZS52ZXJzaW9uID0gQ29uZmlnLklEQl9TQVZFX1ZFUlNJT05cclxuICAgIH1cclxuICAgIERhdGFQcm92aWRlci5pbml0KGRzLCBzYXZlKVxyXG4gIH0sXHJcbiAgYXN5bmMgaW5pdChkYXRhLCBzYXZlKSB7XHJcbiAgICBtZ3JzLmljb24uaW1wb3J0KGRhdGEuaWNvbnMpXHJcbiAgICBtZ3JzLml0ZW0uaW1wb3J0KGRhdGEuaXRlbSlcclxuICAgIG1ncnMucmVjLmltcG9ydChkYXRhLnJlY2lwZSwgbWdycy5pdGVtKVxyXG4gICAgbWdycy5kYXRhID0gZGF0YVxyXG4gICAgRGF0YVByb3ZpZGVyLmxvYWRDYih7bWdyczogbWdycywgc2F2ZTogc2F2ZX0pXHJcbiAgfSxcclxuICBzYXZlR2FtZShkYXRhKSB7XHJcbiAgICBpZihkYXRhKSB7XHJcbiAgICAgIG1ncnMuaWRiLnNldChcIlNhdmVHYW1lXCIsIGRhdGEpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBtZ3JzLmlkYi5kZWwoXCJTYXZlR2FtZVwiKVxyXG4gICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBREE7QUFLQTtBQUxBO0FBQUE7QUFDQTtBQURBO0FBTUE7QUFDQTtBQUNBO0FBUkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQVdBO0FBQ0E7QUFaQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBYUE7QUFDQTtBQWRBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFlQTtBQUNBO0FBaEJBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBaUJBO0FBQ0E7QUFDQTtBQW5CQTtBQW9CQTtBQUNBO0FBckJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBcUJBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBTkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4Q0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///uShe\n");

/***/ })

}]);