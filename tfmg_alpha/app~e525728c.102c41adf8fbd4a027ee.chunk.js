(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["app~e525728c"],{

/***/ "iVpH":
/*!*************************************!*\
  !*** ./src/gameCode/GameObjects.js ***!
  \*************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var IgorJs_main__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! IgorJs/main */ \"7jDb\");\n/* harmony import */ var Chameleon_main__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! Chameleon/main */ \"6juG\");\n\n\n/* *\r\n *  Adding workshop entities from player inventory\r\n */\n\nvar PlayerEntity = function PlayerEntity(params, newObj, Igor) {\n  newObj.buffers = {}; //? Copy static data onto entity,\n  //? surely there's a better way to do this...\n\n  Object.assign(newObj, Igor.data.entity[params.name]);\n\n  if (newObj.subType == \"miner\" || newObj.subType == \"crafter\") {\n    newObj.buffers.out = Igor.newComponent(\"entity.buffer\", {\n      dir: 'out'\n    }, newObj);\n  }\n\n  if (newObj.subType == \"crafter\" || newObj.subType == \"research\") {\n    if (newObj.subType == \"research\") {\n      newObj.buffers.in = Igor.newComponent(\"entity.buffer\", {\n        staticStacks: newObj.inputs,\n        dir: 'in'\n      }, newObj);\n      newObj.research_timer = null;\n      newObj.$_tags.push(\"researchTicker\", true);\n    } else {\n      newObj.buffers.in = Igor.newComponent(\"entity.buffer\", {\n        dir: 'in'\n      }, newObj);\n    }\n  }\n\n  newObj.order = params.idx;\n  return [newObj];\n};\n\nPlayerEntity._delete = function (target, Igor) {\n  target.buffers.in && Igor.deleteObject(target.buffers.in);\n  target.buffers.out && Igor.deleteObject(target.buffers.out);\n};\n\nfunction EntityResearchTicker(entity, tickData, Igor) {\n  var research = Igor.getNamedObject(\"research\").progressing;\n  if (!research) return;\n\n  if (Number.isNaN(entity.research_timer) || entity.research_timer === null) {\n    var _buffer$upgrades$load;\n\n    var canConsume = research.cost.ingredients.every(function (_ref) {\n      var name = _ref[0],\n          qty = _ref[1];\n      return Igor.processTEMP(entity.buffers.in, \"inventory.total\", {\n        name: name\n      }) >= qty;\n    });\n    if (!canConsume) return;\n    research.cost.ingredients.forEach(function (_ref2) {\n      var name = _ref2[0],\n          qty = _ref2[1];\n      Igor.processTEMP(entity.buffers.in, \"inventory.consume\", {\n        itemStacks: {\n          name: name,\n          count: qty\n        }\n      });\n    }); //Consume next units to reset timer\n\n    var buffer = Igor.getId(entity.buffers.in);\n    (buffer == null ? void 0 : (_buffer$upgrades$load = buffer.upgrades.loader) == null ? void 0 : _buffer$upgrades$load.count) && buffer.$_tags.push(\"tick\", \"processing\");\n    entity.research_time = research.cost.time * Igor.config.TICKS_PER_SECOND * entity.researching_speed;\n    entity.research_timer = entity.research_time;\n    return;\n  }\n\n  if (entity.research_timer) {\n    --entity.research_timer;\n  }\n\n  if (entity.research_timer === 0) {\n    Igor.processTEMP(research, \"research.update\", {});\n    entity.research_timer = NaN;\n  }\n\n  Igor.view.signaler.signal(\"bufferUpdate\");\n}\n\nfunction EntityProcessTicker(entity, tickData, Igor) {\n  if (!entity.processing) {\n    entity.$_tags.delete(\"ticking\");\n    return;\n  }\n\n  if (Number.isNaN(entity.process_timer) || entity.process_timer === null) {\n    if (entity.subType == 'miner' || Igor.processTEMP(entity.buffers.in, \"inventory.consume\", {\n      itemStacks: entity.processing.ingredients\n    })) {\n      entity.process_timer = entity.process_ticks;\n    } else {\n      entity.$_tags.delete(\"tick\");\n    }\n\n    return;\n  }\n\n  if (entity.process_timer) {\n    --entity.process_timer;\n  }\n\n  if (entity.process_timer === 0) {\n    var buffer = Igor.getId(entity.buffers.out);\n    var added = Igor.processTEMP(buffer, \"inventory.add\", {\n      itemStacks: entity.buffers.stalled || entity.processing.results || {\n        name: entity.processing.mining_results,\n        count: 1\n      }\n    }); //console.log(added)\n\n    if (added.complete) {\n      var _buffer, _buffer$upgrades$load2, _buffer2, _buffer2$upgrades$loa;\n\n      entity.process_timer = NaN; //Backwards linking... :(\n\n      buffer = Igor.getId(entity.buffers.in);\n      ((_buffer = buffer) == null ? void 0 : (_buffer$upgrades$load2 = _buffer.upgrades.loader) == null ? void 0 : _buffer$upgrades$load2.count) && buffer.$_tags.push(\"tick\", \"processing\");\n      buffer = Igor.getId(entity.buffers.out);\n      ((_buffer2 = buffer) == null ? void 0 : (_buffer2$upgrades$loa = _buffer2.upgrades.loader) == null ? void 0 : _buffer2$upgrades$loa.count) && buffer.$_tags.push(\"tick\", \"processing\");\n    } else {\n      entity.$_tags.delete(\"tick\");\n    }\n  }\n\n  Igor.view.signaler.signal(\"bufferUpdate\");\n}\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].defineObj(\"player.entity\", PlayerEntity, {\n  tick: EntityProcessTicker\n});\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].addObjectTickHandler(\"player.entity\", EntityResearchTicker, \"researchTicker\", {\n  chain: [\"tick\", \"researchTicker\"],\n  num: 3\n});\n/* *\r\n * Resource mining\r\n * Player action\r\n*/\n\nvar ResourceMine = function ResourceMine(obj, Igor, self) {\n  if (self.res) {\n    window.clearTimeout(self.timeout);\n    Igor.view.animsUpdate(self.res, null, null);\n    self.res = undefined;\n  } else {\n    self.timeout = window.setTimeout(function () {\n      Igor.processTEMP(obj.player.inventory, \"inventory.add\", {\n        itemStacks: [{\n          name: obj.which.resource.mining_results,\n          count: 1\n        }]\n      });\n      Igor.view.animsUpdate(self.res, null, null);\n      self.res = undefined;\n    }, obj.which.resource.mining_time * 1000);\n    self.res = obj.which.resource;\n    Igor.view.animsUpdate(obj.which.resource, \"isMining\", obj.which.resource.mining_time);\n  }\n};\n\nwindow.ResourceMine = ResourceMine;\nResourceMine.signature = {\n  which: \"resource\",\n  player: \"inventory\"\n};\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].provide_CCC(\"resources.mine\", ResourceMine, ResourceMine.signature);\n/* *\r\n *  Entity Set processing\r\n */\n\nvar EntitySetProcessSig = {\n  at: \"entity\",\n  which: \"process\",\n  type: \"class\",\n  // enum ['mining', 'crafting', 'lab']\n  player: \"inventory\"\n};\n\nvar EntitySetProcess = function EntitySetProcess(obj, Igor) {\n  if (obj.at.entity.processing || obj.which.process == null) {\n    Igor.processTEMP(obj.at.entity, \"entity.clearProcess\", {\n      returnTo: obj.player.inventory\n    });\n    if (!obj.which.process) return;\n  }\n\n  obj.at.entity.processing = obj.which.process;\n  obj.at.entity.$_tags.push(\"tick\", \"processing\");\n\n  if (obj.type.class == \"mining\") {\n    obj.at.entity.process_ticks = obj.which.process.mining_time / obj.at.entity.mining_speed * Igor.config.TICKS_PER_SECOND;\n    obj.at.entity.process_timer = obj.at.entity.process_ticks;\n  } else if (obj.type.class == \"crafting\") {\n    obj.at.entity.process_ticks = obj.which.process.crafting_speed / obj.at.entity.crafting_speed * Igor.config.TICKS_PER_SECOND;\n\n    if (obj.at.entity.buffers.in) {\n      var buffer = Igor.getId(obj.at.entity.buffers.in);\n\n      if (buffer.stacks < obj.which.process.ingredients.length) {\n        return Igor.view.warnToast(\"Recipe exceedes machines ingredient limit\");\n      }\n\n      obj.which.process.ingredients.forEach(function (item, idx) {\n        buffer.items[idx] = {\n          name: item.name,\n          count: 0\n        };\n      });\n    }\n\n    if (obj.at.entity.buffers.out) {\n      var _buffer3 = Igor.getId(obj.at.entity.buffers.out);\n\n      if (_buffer3.stacks < obj.which.process.results.length) {\n        return Igor.view.warnToast(\"Recipe exceedes machines results limit\");\n      }\n\n      obj.which.process.results.forEach(function (item, idx) {\n        _buffer3.items[idx] = {\n          name: item.name,\n          count: 0\n        };\n      });\n    }\n\n    obj.at.entity.process_timer = NaN;\n  }\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].provide_CCC(\"entity.setProcess\", EntitySetProcess, EntitySetProcessSig);\n\nfunction EntityClearProcess(entity, args, returnObj, Igor) {\n  if (entity.buffers.in) {\n    if (entity.process_timer) {\n      Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n        itemStacks: entity.processing.ingredients\n      });\n    }\n\n    var buffer = Igor.getId(entity.buffers.in);\n    Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n      itemStacks: buffer.items\n    }); //! If args.returnTo is full, 'inventory.add' will fail silently\n\n    buffer.items.length = 0;\n    buffer.xferStack = 0;\n    buffer.stalled = false;\n  }\n\n  if (entity.buffers.out) {\n    var _buffer4 = Igor.getId(entity.buffers.out);\n\n    Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n      itemStacks: _buffer4.items\n    }); //! If args.returnTo is full, 'inventory.add' will fail silently\n\n    _buffer4.items.length = 0;\n    _buffer4.xferStack = 0;\n    _buffer4.stalled = false;\n  }\n\n  if (entity.buffers.stalled) {\n    Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n      itemStacks: entity.buffers.stalled\n    });\n    entity.buffers.stalled = null;\n  }\n\n  entity.processing = null;\n}\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].addOperation(\"entity.clearProcess\", EntityClearProcess);\n/*\r\n  Buffers\r\n */\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].setStatic(\"entityBuffer.sizeExpansionCost\", [{\n  name: \"iron-chest\",\n  count: 1\n}]);\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].setStatic(\"entityBuffer.xferExpansionCost\", [{\n  name: \"inserter\",\n  count: 1\n}]);\n\nvar NewEntityBuffer = function NewEntityBuffer(params, newObj, Igor) {\n  var _params$staticStacks, _params$staticStacks2;\n\n  newObj.upgrades = {};\n  newObj.maxStacks = ((_params$staticStacks = params.staticStacks) == null ? void 0 : _params$staticStacks.length) || params.stacks || 1;\n  newObj.stackSize = params.stackSize || 5;\n  newObj.items = ((_params$staticStacks2 = params.staticStacks) == null ? void 0 : _params$staticStacks2.map(function (x) {\n    return {\n      name: x,\n      count: 0\n    };\n  })) || [];\n  newObj.xfer = 0;\n  newObj.xferTicks = 120;\n  newObj.xferStack = 0;\n  newObj.busShift = 0;\n  newObj.xferTimer = NaN;\n  newObj.restrictable = params.restrictable || false;\n  newObj.connection = null;\n  newObj.dir = params.dir;\n  newObj.active = false;\n  return [newObj];\n};\n\nNewEntityBuffer._delete = function (obj, Igor) {\n  var _obj$upgrades$bufferS, _obj$upgrades$loader;\n\n  var inv = Igor.getNamedObject(\"player.inventory\");\n  ((_obj$upgrades$bufferS = obj.upgrades.bufferSize) == null ? void 0 : _obj$upgrades$bufferS.count) && Igor.processTEMP(inv, \"inventory.add\", {\n    itemStacks: Igor.getStatic(\"entityBuffer.sizeExpansionCost\"),\n    multi: obj.upgrades.bufferSize.count\n  });\n  ((_obj$upgrades$loader = obj.upgrades.loader) == null ? void 0 : _obj$upgrades$loader.count) && Igor.processTEMP(inv, \"inventory.add\", {\n    itemStacks: Igor.getStatic(\"entityBuffer.xferExpansionCost\"),\n    multi: obj.upgrades.loader.count\n  });\n};\n\nvar EntityBufferActions = {};\n\nEntityBufferActions.Collect = function (obj, Igor) {\n  var _buffer$upgrades$load3;\n\n  var buffer = Igor.getId(obj.which.buffer);\n  var idx = buffer.items.findIndex(function (x) {\n    return x.name == obj.item.name;\n  });\n\n  if (idx == -1) {\n    console.warn(\"Didnt' find the right index\");\n    debugger;\n  }\n\n  if (buffer.items[idx].count === 0) return;\n  Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n    itemStacks: buffer.items[idx]\n  });\n  buffer.items[idx].count = 0;\n  Igor.getId(buffer.$_parent).$_tags.push(\"tick\", \"processing\");\n  Igor.view.signaler.signal(\"bufferUpdate\");\n  ((_buffer$upgrades$load3 = buffer.upgrades.loader) == null ? void 0 : _buffer$upgrades$load3.count) && buffer.$_tags.push(\"tick\", \"processing\");\n};\n\nEntityBufferActions.Collect.signature = {\n  which: 'buffer',\n  item: 'name'\n};\nEntityBufferActions.Collect.CC_provide = \"entity.bufferCollect\";\n\nEntityBufferActions.Fill = function (obj, Igor) {\n  var _buffer$upgrades$load4;\n\n  var buffer = Igor.getId(obj.which.buffer);\n  var idx = buffer.items.findIndex(function (x) {\n    return x.name == obj.item.name;\n  });\n\n  if (idx == -1) {\n    console.warn(\"Didnt' find the right index\");\n    debugger;\n  }\n\n  var avail = Igor.processTEMP(\"player.inventory\", \"inventory.total\", {\n    name: buffer.items[idx].name\n  });\n  if (avail === 0) return;\n  var toMove = obj.service.rounder.calc(buffer.items[idx].count, buffer.stackSize, avail);\n  Igor.processTEMP(\"player.inventory\", \"inventory.consume\", {\n    itemStacks: {\n      name: buffer.items[idx].name,\n      count: toMove\n    }\n  });\n  buffer.items[idx].count += toMove;\n  Igor.getId(buffer.$_parent).$_tags.push(\"tick\", \"processing\");\n  Igor.view.signaler.signal(\"bufferUpdate\");\n  ((_buffer$upgrades$load4 = buffer.upgrades.loader) == null ? void 0 : _buffer$upgrades$load4.count) && buffer.$_tags.push(\"tick\", \"processing\");\n};\n\nEntityBufferActions.Fill.signature = {\n  which: 'buffer',\n  item: 'name',\n  service: 'rounder'\n};\nEntityBufferActions.Fill.CC_provide = \"entity.bufferFill\";\n\nEntityBufferActions.ClickCycle = function (obj, Igor) {\n  // The purpose is to cycle between buffer_fill and buffer_collect\n  var buffer = Igor.getId(obj.which.buffer);\n  var itemElm = buffer.items.find(function (x) {\n    return x.name == obj.item.name;\n  });\n  debugger;\n};\n\nEntityBufferActions.ClickCycle.signature = {\n  which: 'buffer',\n  item: 'name',\n  service: 'rounder'\n};\nEntityBufferActions.ClickCycle.CC_provide = \"entity.bufferCycle\";\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].setStatic(\"entity.buffer.BUFFER_SIZE\", [5, 10, 20, 30, 40, 50]);\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].setStatic(\"entity.buffer.BUFFER_SIZE.MAX\", 50);\n\nEntityBufferActions.Upgrade = function (obj, Igor) {\n  var buffer = Igor.getId(obj.which.buffer);\n\n  if (obj.type.string == \"autoload\") {\n    var _buffer$upgrades$load5;\n\n    if (((_buffer$upgrades$load5 = buffer.upgrades.loader) == null ? void 0 : _buffer$upgrades$load5.count) >= 10) return Igor.view.warnToast(\"Loaders full\");\n    if (!Igor.processTEMP(obj.player.inventory, \"inventory.consume\", {\n      itemStacks: {\n        name: \"inserter\",\n        count: 1\n      }\n    })) return Igor.view.warnToast(\"Inserter required\");\n    !buffer.upgrades.loader && (buffer.upgrades.loader = {\n      count: 0\n    });\n    buffer.upgrades.loader.count++;\n    buffer.xferTimer || (buffer.xferTimer = buffer.xferTicks);\n    buffer.xfer++;\n    buffer.active = true;\n    buffer.$_tags.push(\"tick\", \"processing\");\n  } else if (obj.type.string == \"buffer\") {\n    var _buffer$upgrades$buff;\n\n    if (((_buffer$upgrades$buff = buffer.upgrades.bufferSize) == null ? void 0 : _buffer$upgrades$buff.count) >= 6) return Igor.view.warnToast(\"Chests full\");\n    if (!Igor.processTEMP(obj.player.inventory, \"inventory.consume\", {\n      itemStacks: {\n        name: \"iron-chest\",\n        count: 1\n      }\n    })) return Igor.view.warnToast(\"Iron chest required\");\n    !buffer.upgrades.bufferSize && (buffer.upgrades.bufferSize = {\n      count: 0\n    });\n    buffer.upgrades.bufferSize.count++;\n    buffer.stackSize = Igor.getStatic(\"entity.buffer.BUFFER_SIZE\")[buffer.upgrades.bufferSize.count] || Igor.getStatic(\"entity.buffer.BUFFER_SIZE.MAX\");\n  }\n};\n\nEntityBufferActions.Upgrade.signature = {\n  which: \"buffer\",\n  type: \"string\",\n  player: 'inventory'\n};\nEntityBufferActions.Upgrade.CC_provide = \"entity.bufferUpgrade\";\n\nEntityBufferActions.SetRestrictions = function (target, args, returnObj, Igor) {\n  if (!target.restrictable) returnObj._result = false; //check through the list and return things to player buffer\n\n  var connected = [];\n  var emptyIdxs = [];\n  target.maxStacks = args.list.length;\n\n  for (var idx = 0; idx < target.items.length; idx++) {\n    var x = target.items[idx];\n\n    if (!x) {\n      emptyIdxs.push(idx);\n      continue;\n    }\n\n    if (!args.list.includes(x.name)) {\n      if (x.count > 0) Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n        itemStacks: x\n      });\n      target.items.splice(idx, 1, undefined);\n      emptyIdxs.push(idx);\n    } else {\n      connected.push(x.name);\n      x.restricted = true;\n    }\n  } //console.log(emptyIdxs)\n\n\n  args.list.forEach(function (x) {\n    if (!connected.includes(x)) {\n      if (emptyIdxs.length > 0) {\n        target.items.splice(emptyIdxs.splice(0, 1), 1, {\n          name: x,\n          count: 0,\n          restricted: true\n        }); //console.log(\"restricted splice \"+x)\n      } else {\n        target.items.push({\n          name: x,\n          count: 0,\n          restricted: true\n        }); //console.log('push restricted:'+x)\n      }\n    }\n  });\n};\n\nEntityBufferActions.SetRestrictions.Igor_operation = \"buffer.restrictList\";\n\nEntityBufferActions.HasRestriction = function (target, args, returnObj, Igor) {\n  if (!target.restrictable) returnObj._result = false;else {\n    target.items.forEach(function (x) {\n      if (x.name == args.itemName) {\n        if (x.restrictedBy.includes(args.lineId)) {\n          returnObj._result = {\n            found: true,\n            restricted: true\n          };\n        } else {\n          returnObj._result = {\n            found: true,\n            restricted: false\n          };\n        }\n      }\n    });\n  }\n  !returnObj._result && (returnObj._result = {\n    found: false,\n    restricted: false\n  });\n};\n\nEntityBufferActions.HasRestriction.Igor_operation = \"buffer.hasRestriction\";\n\nEntityBufferActions.ClearRestriction = function (target, args, returnObj, Igor) {\n  if (!target.restrictable) returnObj._result = false;\n  var idx = -1;\n\n  while (!(\"_result\" in returnObj)) {\n    var x = target.items[++idx];\n\n    if (x.name == args.itemName) {\n      x.restrictedBy.splice(x.restrictedBy.indexOf(args.lineId), 1);\n\n      if (x.restrictedBy.length == 0) {\n        target.items[idx] = null;\n        returnObj._result = {\n          found: true,\n          cleared: true\n        };\n      } else {\n        returnObj._result = {\n          found: true,\n          cleared: false\n        };\n      }\n    }\n  }\n\n  !returnObj._result && (returnObj._result = {\n    found: false,\n    cleared: false\n  });\n};\n\nEntityBufferActions.ClearRestriction.Igor_operation = \"buffer.clearRestriction\";\n\nEntityBufferActions.BusXfer = function (target, args, returnObj, Igor) {\n  //TODO need better protections for transfers\n  //TODO need to handle different item stacks\n  // setup filter priorities for output \n  if (args.toBus) {\n    while (args.xferCount > 0) {\n      if (!target.items[target.busShift]) return null;\n      var added = Igor.processTEMP(args.toBus, \"inventory.add\", {\n        itemStacks: [{\n          name: target.items[target.busShift].name,\n          count: args.xferCount\n        }]\n      });\n\n      if (added.complete) {\n        Igor.processTEMP(target, \"inventory.consume\", {\n          itemStacks: [{\n            name: target.items[target.busShift].name,\n            count: args.xferCount\n          }]\n        });\n        args.xferCount = 0;\n      } else if (added.part[0].count == args.xferCount) {\n        returnObj.full = true;\n        return;\n      } else {\n        Igor.processTEMP(target, \"inventory.consume\", {\n          itemStacks: [{\n            name: target.items[target.busShift].name,\n            count: args.xferCount - added.part[0].count\n          }]\n        });\n        args.xferCount = added.part[0].count;\n      }\n\n      ++target.busShift == target.items.length && (target.busShift = 0);\n    }\n\n    returnObj.complete = true;\n  } else if (args.fromBus) {\n    var loops = 0;\n\n    while (args.xferCount > 0) {\n      if (!target.items[target.busShift]) return null;\n      var space = target.stackSize - target.items[target.busShift].count;\n\n      if (space) {\n        var consumed = Igor.processTEMP(args.fromBus, \"inventory.consume\", {\n          itemStacks: [{\n            name: target.items[target.busShift].name,\n            count: Math.min(args.xferCount, space)\n          }],\n          partial: true\n        });\n\n        if (consumed[0].count > 0) {\n          Igor.processTEMP(target, \"inventory.add\", {\n            itemStacks: [{\n              name: target.items[target.busShift].name,\n              count: consumed[0].count\n            }]\n          });\n          args.xferCount -= consumed[0].count;\n        }\n      }\n\n      if (++loops == target.items.length) {\n        returnObj.full = true;\n        return;\n      }\n\n      ++target.busShift == target.items.length && (target.busShift = 0);\n    }\n\n    returnObj.complete = true;\n  } else {\n    console.warn(\"BusXfer called __ no bus target\");\n  }\n};\n\nEntityBufferActions.BusXfer.Igor_operation = \"buffer.busXfer\";\n\nEntityBufferActions.BufferStalled = function (buffer, args, returnObj, Igor) {\n  /* more advanced stall handling, then return*/\n  //console.log('stalled start'+buffer.items.length)\n  buffer.stalled = true;\n  buffer.xferTimer = Math.floor(buffer.xferTicks / 6);\n  ++buffer.xferStack == buffer.items.length && (buffer.xferStack = 0);\n};\n\nEntityBufferActions.BufferStalled.Igor_operation = \"buffer.setStall\";\n\nEntityBufferActions.tick = function (buffer, tickData, Igor) {\n  if (buffer.items.length == 0 || !buffer.active) return;\n  if (buffer.xferTimer) return buffer.xferTimer--; //Surely a more elegant way to run this...\n  //TODO need to alter stacks if not completely xferd\n\n  if (buffer.dir == 'in') {\n    var toAdd = Math.min(buffer.xfer, buffer.stackSize - buffer.items[buffer.xferStack].count);\n    if (toAdd == 0) return Igor.processTEMP(buffer, \"buffer.setStall\");\n    var acquired = Igor.processTEMP(\"player.inventory\", \"inventory.consume\", {\n      itemStacks: {\n        name: buffer.items[buffer.xferStack].name,\n        count: toAdd\n      },\n      partial: true\n    });\n    if (acquired[0].count == 0) return Igor.processTEMP(buffer, \"buffer.setStall\");\n    buffer.items[buffer.xferStack].count += acquired[0].count;\n  } else {\n    var xfer = buffer.items[buffer.xferStack];\n    var added = Igor.processTEMP(\"player.inventory\", \"inventory.add\", {\n      itemStacks: {\n        name: xfer.name,\n        count: Math.min(xfer.count, buffer.xfer)\n      },\n      stackLimit: 1\n    }); //console.log(added)\n\n    if (!added.complete) return Igor.processTEMP(buffer, \"buffer.setStall\");\n    xfer.count -= Math.min(xfer.count, buffer.xfer); //\n  }\n\n  ++buffer.xferStack == buffer.items.length && (buffer.xferStack = 0);\n  buffer.xferTimer = buffer.xferTicks;\n  buffer.stalled = false;\n  Igor.getId(buffer.$_parent).$_tags.push(\"tick\", \"processing\");\n  Igor.view.signaler.signal(\"bufferUpdate\");\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].defineObj(\"entity.buffer\", NewEntityBuffer, EntityBufferActions);\n/*\r\n *  Research Related\r\n *\r\n */\n\nvar SetResearchSig = {\n  \"which\": \"tech\",\n  \"global\": \"game\"\n};\n\nvar SetResearch = function SetResearch(obj, Igor, self) {\n  obj.global.game.research.progressing = obj.which.tech;\n  obj.global.game.research.progressing.completeUnits = 0;\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].provide_CCC(\"research.set\", SetResearch, SetResearchSig);\nvar ClearResearchSig = {\n  \"global\": \"game\"\n};\n\nvar ClearResearch = function ClearResearch(obj, Igor, self) {\n  obj.global.game.research.progressing = null;\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].provide_CCC(\"research.clear\", ClearResearch, ClearResearchSig); //Returns extra portion, but I don't have a good solution\n//To adding it back to the factoryBlock\n\nvar ResearchUpdate = function ResearchUpdate(obj, args, returnObj, Igor) {\n  var global = Igor.getNamedObject(\"global\");\n  obj.completeUnits += args.count || 1;\n\n  if (obj.completeUnits >= obj.cost.count) {\n    Igor.view.goodToast(\"Research Complete: \" + obj.name);\n    returnObj._result = obj.completeUnits - obj.cost.count;\n    Igor.getNamedObject(\"research\").progressing = null;\n    obj.researched = true;\n    global.research.completed[obj.name] = true;\n    obj.unlocks.forEach(function (item) {\n      typeof item === 'string' && Igor.processTEMP(item, \"recipe.unlock\");\n      typeof item === 'object' && Igor.processTEMP(item, \"feature.unlock\");\n    });\n    var cost = obj.cost.ingredients.map(function (_ref3) {\n      var name = _ref3[0],\n          qty = _ref3[1];\n      return {\n        name: name,\n        count: qty\n      };\n    }); //TODO! need to update this to respond to different tech trees\n\n    global.player.workshop.entities.forEach(function (x) {\n      var ent = Igor.getId(x);\n\n      if (ent.name == \"lab\") {\n        Igor.processTEMP(ent.buffers.in, \"inventory.add\", {\n          itemStacks: cost,\n          force: true\n        });\n        ent.research_timer = NaN;\n      }\n    });\n    global.facBlocks.techBlocks.forEach(function (x) {\n      if (args.me == x) return;\n      var block = Igor.getId(x);\n\n      if (block.research_consumed) {\n        Igor.processTEMP(block.buffers.in, \"inventory.add\", {\n          itemStacks: cost,\n          force: true,\n          multi: research_consumed\n        });\n        block.research_consumed = 0;\n        block.research_ticks = NaN;\n      }\n    });\n    Chameleon_main__WEBPACK_IMPORTED_MODULE_1__[\"ChameleonViewer\"].signaler.signal(\"techResearched\");\n  }\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].addOperation(\"research.update\", ResearchUpdate);\n\nvar RecipeUnlock = function RecipeUnlock(obj, args, returnObj, Igor) {\n  //Igor.data.recipe[obj].enabled = true\n  Igor.getNamedObject(\"global\").unlocked_recipes.push(obj);\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].addOperation(\"recipe.unlock\", RecipeUnlock);\n\nvar FeatureUnlock = function FeatureUnlock(obj, args, returnObj, Igor) {\n  var features = Igor.getNamedObject(\"global\").activeFeatures;\n\n  if (features[obj.feature]) {\n    features[obj.feature] = obj;\n  } else {\n    //! needs something more elegant...\n    if (obj.feature == \"factoryBlocks\") {\n      var blocks = Igor.getNamedObject(\"global\").facBlocks.blocks;\n\n      if (obj.blocksMaxSources) {\n        blocks.forEach(function (id) {\n          Igor.getId(id).connections.maxSources = obj.blocksMaxSources;\n        });\n      }\n\n      if (obj.blocksMaxDrains) {\n        blocks.forEach(function (id) {\n          Igor.getId(id).connections.maxDrains = obj.blocksMaxDrains;\n        });\n      }\n    }\n\n    debugger;\n    Object.assign(features[obj.feature], obj);\n  }\n  /*\r\n  adjustFeature(obj) {\r\n    switch(obj.feature) {\r\n      case \"defense\":\r\n        if(!this.activeFeatures[\"defense\"]) {\r\n          this.activeFeatures[\"defense\"] = true\r\n          this.facBlocks.defenses = NamedBlocks.DefenseBlock()\r\n          this.facBlocks.defenseBus = NamedBlocks.DefenseBus()\r\n        }\r\n        this.facBlocks.defenses.machines[\"turret\"] = ChameView.GameObjectFromPointer(obj.go_pointer)  //!!! shouldn't be in Chameleon\r\n        break;\r\n      case \"offense\":\r\n        if(!this.activeFeatures[\"offense\"]) {\r\n          this.activeFeatures[\"offense\"] = true\r\n          this.facBlocks.offenses = NamedBlocks.OffenseBlock()\r\n          this.facBlocks.offenseBus = NamedBlocks.OffenseBus()\r\n        }\r\n        this.facBlocks.offenses.radar = ChameView.GameObjectFromPointer(obj.go_pointer)  //!!! shouldn't be in Chameleon\r\n        break;\r\n      case \"factoryBlocks\":\r\n        this.activeFeatures[\"factoryBlocks\"] = true\r\n    }\r\n    // this.activeFeatures[obj.feature] = obj.level || (this.activeFeatures[obj.feature]+obj.inc) || (this.activeFeatures[obj.feature] * obj.bonus) || true\r\n  }\r\n  */\n\n};\n\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].addOperation(\"feature.unlock\", FeatureUnlock);\n\nvar CraftFromInv = function CraftFromInv(obj, Igor, fn) {\n  if (fn.rec) {\n    window.clearTimeout(fn.timeout);\n    Igor.processTEMP(obj.player.inventory, \"inventory.add\", {\n      itemStacks: fn.rec.ingredients\n    });\n    Chameleon_main__WEBPACK_IMPORTED_MODULE_1__[\"ChameleonViewer\"].animsUpdate(fn.rec, null, null);\n    fn.rec = undefined;\n  } else {\n    if (Igor.processTEMP(obj.player.inventory, \"inventory.consume\", {\n      itemStacks: obj.which.recipe.ingredients\n    })) {\n      fn.rec = obj.which.recipe;\n      fn.timeout = window.setTimeout(function () {\n        Igor.processTEMP(obj.player.inventory, \"inventory.add\", {\n          itemStacks: fn.rec.results\n        });\n        Chameleon_main__WEBPACK_IMPORTED_MODULE_1__[\"ChameleonViewer\"].animsUpdate(fn.rec, null, null);\n        fn.rec = undefined;\n      }, obj.which.recipe.crafting_speed * 1000);\n      fn.rec = obj.which.recipe;\n      Chameleon_main__WEBPACK_IMPORTED_MODULE_1__[\"ChameleonViewer\"].animsUpdate(fn.rec, \"isCrafting\", obj.which.recipe.crafting_speed);\n    } else {\n      //Error alert: cannot build\n      Igor.view.warnToast(\"Not enough ingredients to craft\");\n      console.log('cannot craft');\n    }\n  }\n};\n\nCraftFromInv.signature = {\n  which: \"recipe\",\n  player: \"inventory\"\n};\nIgorJs_main__WEBPACK_IMPORTED_MODULE_0__[\"IgorUtils\"].provide_CCC(\"player.craft\", CraftFromInv, CraftFromInv.signature);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaVZwSC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9nYW1lQ29kZS9HYW1lT2JqZWN0cy5qcz84OTVhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SWdvclV0aWxzIGFzIElnb3JKc30gZnJvbSBcIklnb3JKcy9tYWluXCJcclxuaW1wb3J0IHtDaGFtZWxlb25WaWV3ZXIgYXMgQ2hhbWVKc30gZnJvbSBcIkNoYW1lbGVvbi9tYWluXCJcclxuXHJcbi8qICpcclxuICogIEFkZGluZyB3b3Jrc2hvcCBlbnRpdGllcyBmcm9tIHBsYXllciBpbnZlbnRvcnlcclxuICovXHJcblxyXG5jb25zdCBQbGF5ZXJFbnRpdHkgPSAocGFyYW1zLCBuZXdPYmosIElnb3IpID0+IHtcclxuICBuZXdPYmouYnVmZmVycyA9IHt9XHJcbiAgLy8/IENvcHkgc3RhdGljIGRhdGEgb250byBlbnRpdHksXHJcbiAgLy8/IHN1cmVseSB0aGVyZSdzIGEgYmV0dGVyIHdheSB0byBkbyB0aGlzLi4uXHJcbiAgT2JqZWN0LmFzc2lnbihuZXdPYmosIElnb3IuZGF0YS5lbnRpdHlbcGFyYW1zLm5hbWVdKVxyXG4gIGlmKG5ld09iai5zdWJUeXBlPT1cIm1pbmVyXCIgfHwgbmV3T2JqLnN1YlR5cGU9PVwiY3JhZnRlclwiKSB7XHJcbiAgICBuZXdPYmouYnVmZmVycy5vdXQgPSBJZ29yLm5ld0NvbXBvbmVudChcImVudGl0eS5idWZmZXJcIiwge2RpcjogJ291dCd9LCBuZXdPYmopXHJcbiAgfVxyXG4gIGlmKG5ld09iai5zdWJUeXBlPT1cImNyYWZ0ZXJcIiB8fCBuZXdPYmouc3ViVHlwZT09XCJyZXNlYXJjaFwiKSB7XHJcbiAgICBpZihuZXdPYmouc3ViVHlwZT09XCJyZXNlYXJjaFwiKSB7XHJcbiAgICAgIG5ld09iai5idWZmZXJzLmluID0gSWdvci5uZXdDb21wb25lbnQoXCJlbnRpdHkuYnVmZmVyXCIsIHtzdGF0aWNTdGFja3M6IG5ld09iai5pbnB1dHMsIGRpcjogJ2luJ30sIG5ld09iailcclxuICAgICAgbmV3T2JqLnJlc2VhcmNoX3RpbWVyID0gbnVsbFxyXG4gICAgICBuZXdPYmouJF90YWdzLnB1c2goXCJyZXNlYXJjaFRpY2tlclwiLCB0cnVlKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbmV3T2JqLmJ1ZmZlcnMuaW4gPSBJZ29yLm5ld0NvbXBvbmVudChcImVudGl0eS5idWZmZXJcIiwgeyBkaXI6ICdpbid9LCBuZXdPYmopXHJcbiAgICB9XHJcbiAgfVxyXG4gIG5ld09iai5vcmRlciA9IHBhcmFtcy5pZHhcclxuICByZXR1cm4gW25ld09ial1cclxufVxyXG5QbGF5ZXJFbnRpdHkuX2RlbGV0ZSA9ICh0YXJnZXQsIElnb3IpID0+IHtcclxuICB0YXJnZXQuYnVmZmVycy5pbiAgJiYgSWdvci5kZWxldGVPYmplY3QodGFyZ2V0LmJ1ZmZlcnMuaW4pXHJcbiAgdGFyZ2V0LmJ1ZmZlcnMub3V0ICYmIElnb3IuZGVsZXRlT2JqZWN0KHRhcmdldC5idWZmZXJzLm91dClcclxufVxyXG5mdW5jdGlvbiBFbnRpdHlSZXNlYXJjaFRpY2tlcihlbnRpdHksIHRpY2tEYXRhLCBJZ29yKSB7XHJcbiAgbGV0IHJlc2VhcmNoID0gSWdvci5nZXROYW1lZE9iamVjdChcInJlc2VhcmNoXCIpLnByb2dyZXNzaW5nXHJcbiAgaWYoIXJlc2VhcmNoKSByZXR1cm5cclxuICBpZihOdW1iZXIuaXNOYU4oZW50aXR5LnJlc2VhcmNoX3RpbWVyKSB8fCBlbnRpdHkucmVzZWFyY2hfdGltZXI9PT1udWxsKSB7XHJcbiAgICBsZXQgY2FuQ29uc3VtZSA9IHJlc2VhcmNoLmNvc3QuaW5ncmVkaWVudHMuZXZlcnkoKFtuYW1lLCBxdHldKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIElnb3IucHJvY2Vzc1RFTVAoZW50aXR5LmJ1ZmZlcnMuaW4sIFwiaW52ZW50b3J5LnRvdGFsXCIsIHtuYW1lfSk+PXF0eVxyXG4gICAgICB9KVxyXG4gICAgaWYoIWNhbkNvbnN1bWUpIHJldHVyblxyXG4gICAgcmVzZWFyY2guY29zdC5pbmdyZWRpZW50cy5mb3JFYWNoKCAoW25hbWUsIHF0eV0pID0+IHtcclxuICAgICAgSWdvci5wcm9jZXNzVEVNUChlbnRpdHkuYnVmZmVycy5pbiwgXCJpbnZlbnRvcnkuY29uc3VtZVwiLCB7aXRlbVN0YWNrczoge25hbWUsIGNvdW50OiBxdHl9fSlcclxuICAgIH0pXHJcbiAgICAvL0NvbnN1bWUgbmV4dCB1bml0cyB0byByZXNldCB0aW1lclxyXG4gICAgbGV0IGJ1ZmZlciA9IElnb3IuZ2V0SWQoZW50aXR5LmJ1ZmZlcnMuaW4pXHJcbiAgICBidWZmZXI/LnVwZ3JhZGVzLmxvYWRlcj8uY291bnQgJiYgYnVmZmVyLiRfdGFncy5wdXNoKFwidGlja1wiLCBcInByb2Nlc3NpbmdcIilcclxuICAgIGVudGl0eS5yZXNlYXJjaF90aW1lID0gcmVzZWFyY2guY29zdC50aW1lICogSWdvci5jb25maWcuVElDS1NfUEVSX1NFQ09ORCAqIGVudGl0eS5yZXNlYXJjaGluZ19zcGVlZFxyXG4gICAgZW50aXR5LnJlc2VhcmNoX3RpbWVyID0gZW50aXR5LnJlc2VhcmNoX3RpbWVcclxuICAgIHJldHVyblxyXG4gIH1cclxuICBpZihlbnRpdHkucmVzZWFyY2hfdGltZXIpIHsgLS1lbnRpdHkucmVzZWFyY2hfdGltZXIgfVxyXG4gIGlmKGVudGl0eS5yZXNlYXJjaF90aW1lcj09PTApIHtcclxuICAgIElnb3IucHJvY2Vzc1RFTVAocmVzZWFyY2gsIFwicmVzZWFyY2gudXBkYXRlXCIsIHt9KVxyXG4gICAgZW50aXR5LnJlc2VhcmNoX3RpbWVyID0gTmFOXHJcbiAgfVxyXG4gIElnb3Iudmlldy5zaWduYWxlci5zaWduYWwoXCJidWZmZXJVcGRhdGVcIilcclxufVxyXG5mdW5jdGlvbiBFbnRpdHlQcm9jZXNzVGlja2VyKGVudGl0eSwgdGlja0RhdGEsIElnb3IpIHtcclxuICBpZighZW50aXR5LnByb2Nlc3NpbmcpIHsgZW50aXR5LiRfdGFncy5kZWxldGUoXCJ0aWNraW5nXCIpOyByZXR1cm4gfVxyXG4gIGlmKE51bWJlci5pc05hTihlbnRpdHkucHJvY2Vzc190aW1lcikgfHwgZW50aXR5LnByb2Nlc3NfdGltZXI9PT1udWxsKSB7XHJcbiAgICBpZihlbnRpdHkuc3ViVHlwZT09J21pbmVyJyB8fCBJZ29yLnByb2Nlc3NURU1QKGVudGl0eS5idWZmZXJzLmluLCBcImludmVudG9yeS5jb25zdW1lXCIsIHtpdGVtU3RhY2tzOiBlbnRpdHkucHJvY2Vzc2luZy5pbmdyZWRpZW50c30pKSB7XHJcbiAgICAgIGVudGl0eS5wcm9jZXNzX3RpbWVyID0gZW50aXR5LnByb2Nlc3NfdGlja3NcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGVudGl0eS4kX3RhZ3MuZGVsZXRlKFwidGlja1wiKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG4gIGlmKGVudGl0eS5wcm9jZXNzX3RpbWVyKSB7IC0tZW50aXR5LnByb2Nlc3NfdGltZXIgfVxyXG4gIGlmKGVudGl0eS5wcm9jZXNzX3RpbWVyPT09MCkge1xyXG4gICAgbGV0IGJ1ZmZlciA9IElnb3IuZ2V0SWQoZW50aXR5LmJ1ZmZlcnMub3V0KVxyXG4gICAgbGV0IGFkZGVkID0gSWdvci5wcm9jZXNzVEVNUChidWZmZXIsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogZW50aXR5LmJ1ZmZlcnMuc3RhbGxlZCB8fCBlbnRpdHkucHJvY2Vzc2luZy5yZXN1bHRzIHx8IHtuYW1lOiBlbnRpdHkucHJvY2Vzc2luZy5taW5pbmdfcmVzdWx0cywgY291bnQ6IDF9fSlcclxuICAgIC8vY29uc29sZS5sb2coYWRkZWQpXHJcbiAgICBpZihhZGRlZC5jb21wbGV0ZSkge1xyXG4gICAgICBlbnRpdHkucHJvY2Vzc190aW1lciA9IE5hTlxyXG4gICAgICAvL0JhY2t3YXJkcyBsaW5raW5nLi4uIDooXHJcbiAgICAgIGJ1ZmZlciA9IElnb3IuZ2V0SWQoZW50aXR5LmJ1ZmZlcnMuaW4pXHJcbiAgICAgIGJ1ZmZlcj8udXBncmFkZXMubG9hZGVyPy5jb3VudCAmJiBidWZmZXIuJF90YWdzLnB1c2goXCJ0aWNrXCIsIFwicHJvY2Vzc2luZ1wiKVxyXG4gICAgICBidWZmZXIgPSBJZ29yLmdldElkKGVudGl0eS5idWZmZXJzLm91dClcclxuICAgICAgYnVmZmVyPy51cGdyYWRlcy5sb2FkZXI/LmNvdW50ICYmIGJ1ZmZlci4kX3RhZ3MucHVzaChcInRpY2tcIiwgXCJwcm9jZXNzaW5nXCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBlbnRpdHkuJF90YWdzLmRlbGV0ZShcInRpY2tcIilcclxuICAgIH1cclxuICB9XHJcbiAgSWdvci52aWV3LnNpZ25hbGVyLnNpZ25hbChcImJ1ZmZlclVwZGF0ZVwiKVxyXG59XHJcbklnb3JKcy5kZWZpbmVPYmooXCJwbGF5ZXIuZW50aXR5XCIsIFBsYXllckVudGl0eSwge3RpY2s6IEVudGl0eVByb2Nlc3NUaWNrZXJ9KVxyXG5JZ29ySnMuYWRkT2JqZWN0VGlja0hhbmRsZXIoXCJwbGF5ZXIuZW50aXR5XCIsIEVudGl0eVJlc2VhcmNoVGlja2VyLCBcInJlc2VhcmNoVGlja2VyXCIsIHtjaGFpbjogW1widGlja1wiLCBcInJlc2VhcmNoVGlja2VyXCJdLCBudW06IDN9KVxyXG5cclxuLyogKlxyXG4gKiBSZXNvdXJjZSBtaW5pbmdcclxuICogUGxheWVyIGFjdGlvblxyXG4qL1xyXG5jb25zdCBSZXNvdXJjZU1pbmUgPSAob2JqLCBJZ29yLCBzZWxmKSA9PiB7XHJcbiAgaWYoc2VsZi5yZXMpIHtcclxuICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoc2VsZi50aW1lb3V0KVxyXG4gICAgSWdvci52aWV3LmFuaW1zVXBkYXRlKHNlbGYucmVzLCBudWxsLCBudWxsKVxyXG4gICAgc2VsZi5yZXMgPSB1bmRlZmluZWRcclxuICB9IGVsc2Uge1xyXG4gICAgc2VsZi50aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcclxuICAgICAgSWdvci5wcm9jZXNzVEVNUChvYmoucGxheWVyLmludmVudG9yeSwgXCJpbnZlbnRvcnkuYWRkXCIsIHtpdGVtU3RhY2tzOiBbe25hbWU6IG9iai53aGljaC5yZXNvdXJjZS5taW5pbmdfcmVzdWx0cywgY291bnQ6IDF9XX0pXHJcbiAgICAgIElnb3Iudmlldy5hbmltc1VwZGF0ZShzZWxmLnJlcywgbnVsbCwgbnVsbClcclxuICAgICAgc2VsZi5yZXMgPSB1bmRlZmluZWRcclxuICAgIH0sIG9iai53aGljaC5yZXNvdXJjZS5taW5pbmdfdGltZSAqIDEwMDApXHJcbiAgICBzZWxmLnJlcyA9IG9iai53aGljaC5yZXNvdXJjZVxyXG4gICAgSWdvci52aWV3LmFuaW1zVXBkYXRlKG9iai53aGljaC5yZXNvdXJjZSwgXCJpc01pbmluZ1wiLCBvYmoud2hpY2gucmVzb3VyY2UubWluaW5nX3RpbWUpXHJcbiAgfVxyXG59XHJcbndpbmRvdy5SZXNvdXJjZU1pbmUgPSBSZXNvdXJjZU1pbmVcclxuXHJcblJlc291cmNlTWluZS5zaWduYXR1cmUgPSB7XHJcbiAgd2hpY2g6IFwicmVzb3VyY2VcIixcclxuICBwbGF5ZXI6IFwiaW52ZW50b3J5XCJcclxufVxyXG5cclxuSWdvckpzLnByb3ZpZGVfQ0NDKFwicmVzb3VyY2VzLm1pbmVcIiwgUmVzb3VyY2VNaW5lLCBSZXNvdXJjZU1pbmUuc2lnbmF0dXJlKVxyXG5cclxuLyogKlxyXG4gKiAgRW50aXR5IFNldCBwcm9jZXNzaW5nXHJcbiAqL1xyXG5jb25zdCBFbnRpdHlTZXRQcm9jZXNzU2lnID0ge1xyXG4gIGF0OiBcImVudGl0eVwiLFxyXG4gIHdoaWNoOiBcInByb2Nlc3NcIixcclxuICB0eXBlOiBcImNsYXNzXCIsICAvLyBlbnVtIFsnbWluaW5nJywgJ2NyYWZ0aW5nJywgJ2xhYiddXHJcbiAgcGxheWVyOiBcImludmVudG9yeVwiLFxyXG59XHJcbmNvbnN0IEVudGl0eVNldFByb2Nlc3MgPSAob2JqLCBJZ29yKSA9PiB7XHJcbiAgaWYob2JqLmF0LmVudGl0eS5wcm9jZXNzaW5nIHx8IG9iai53aGljaC5wcm9jZXNzPT1udWxsKSB7XHJcbiAgICBJZ29yLnByb2Nlc3NURU1QKG9iai5hdC5lbnRpdHksIFwiZW50aXR5LmNsZWFyUHJvY2Vzc1wiLCB7cmV0dXJuVG86IG9iai5wbGF5ZXIuaW52ZW50b3J5fSlcclxuICAgIGlmKCFvYmoud2hpY2gucHJvY2VzcykgcmV0dXJuXHJcbiAgfVxyXG4gIG9iai5hdC5lbnRpdHkucHJvY2Vzc2luZyA9IG9iai53aGljaC5wcm9jZXNzXHJcbiAgb2JqLmF0LmVudGl0eS4kX3RhZ3MucHVzaChcInRpY2tcIiwgXCJwcm9jZXNzaW5nXCIpXHJcbiAgaWYob2JqLnR5cGUuY2xhc3M9PVwibWluaW5nXCIpIHtcclxuICAgIG9iai5hdC5lbnRpdHkucHJvY2Vzc190aWNrcyA9IG9iai53aGljaC5wcm9jZXNzLm1pbmluZ190aW1lIC8gb2JqLmF0LmVudGl0eS5taW5pbmdfc3BlZWQgKiBJZ29yLmNvbmZpZy5USUNLU19QRVJfU0VDT05EXHJcbiAgICBvYmouYXQuZW50aXR5LnByb2Nlc3NfdGltZXIgPSBvYmouYXQuZW50aXR5LnByb2Nlc3NfdGlja3NcclxuICB9IGVsc2UgaWYgKG9iai50eXBlLmNsYXNzPT1cImNyYWZ0aW5nXCIpIHtcclxuICAgIG9iai5hdC5lbnRpdHkucHJvY2Vzc190aWNrcyA9IG9iai53aGljaC5wcm9jZXNzLmNyYWZ0aW5nX3NwZWVkIC8gb2JqLmF0LmVudGl0eS5jcmFmdGluZ19zcGVlZCAqIElnb3IuY29uZmlnLlRJQ0tTX1BFUl9TRUNPTkRcclxuICAgIGlmKG9iai5hdC5lbnRpdHkuYnVmZmVycy5pbikge1xyXG4gICAgICBsZXQgYnVmZmVyID0gSWdvci5nZXRJZChvYmouYXQuZW50aXR5LmJ1ZmZlcnMuaW4pXHJcbiAgICAgIGlmKGJ1ZmZlci5zdGFja3M8b2JqLndoaWNoLnByb2Nlc3MuaW5ncmVkaWVudHMubGVuZ3RoKSB7IHJldHVybiBJZ29yLnZpZXcud2FyblRvYXN0KFwiUmVjaXBlIGV4Y2VlZGVzIG1hY2hpbmVzIGluZ3JlZGllbnQgbGltaXRcIikgfVxyXG4gICAgICBvYmoud2hpY2gucHJvY2Vzcy5pbmdyZWRpZW50cy5mb3JFYWNoKCAoaXRlbSwgaWR4KSA9PiB7YnVmZmVyLml0ZW1zW2lkeF0gPSB7bmFtZTogaXRlbS5uYW1lLCBjb3VudDogMH07IH0pXHJcbiAgICB9XHJcbiAgICBpZihvYmouYXQuZW50aXR5LmJ1ZmZlcnMub3V0KSB7XHJcbiAgICAgIGxldCBidWZmZXIgPSBJZ29yLmdldElkKG9iai5hdC5lbnRpdHkuYnVmZmVycy5vdXQpXHJcbiAgICAgIGlmKGJ1ZmZlci5zdGFja3M8b2JqLndoaWNoLnByb2Nlc3MucmVzdWx0cy5sZW5ndGgpIHsgcmV0dXJuIElnb3Iudmlldy53YXJuVG9hc3QoXCJSZWNpcGUgZXhjZWVkZXMgbWFjaGluZXMgcmVzdWx0cyBsaW1pdFwiKSB9XHJcbiAgICAgIG9iai53aGljaC5wcm9jZXNzLnJlc3VsdHMuZm9yRWFjaCggKGl0ZW0sIGlkeCkgPT4ge2J1ZmZlci5pdGVtc1tpZHhdID0ge25hbWU6IGl0ZW0ubmFtZSwgY291bnQ6IDB9O30pXHJcbiAgICB9XHJcbiAgICBvYmouYXQuZW50aXR5LnByb2Nlc3NfdGltZXIgPSBOYU5cclxuICB9XHJcbn1cclxuSWdvckpzLnByb3ZpZGVfQ0NDKFwiZW50aXR5LnNldFByb2Nlc3NcIiwgRW50aXR5U2V0UHJvY2VzcywgRW50aXR5U2V0UHJvY2Vzc1NpZylcclxuXHJcbmZ1bmN0aW9uIEVudGl0eUNsZWFyUHJvY2VzcyhlbnRpdHksIGFyZ3MsIHJldHVybk9iaiwgSWdvcikge1xyXG4gIGlmKGVudGl0eS5idWZmZXJzLmluKSB7XHJcbiAgICBpZihlbnRpdHkucHJvY2Vzc190aW1lcikge1xyXG4gICAgICBJZ29yLnByb2Nlc3NURU1QKFwicGxheWVyLmludmVudG9yeVwiLCBcImludmVudG9yeS5hZGRcIiwge2l0ZW1TdGFja3M6IGVudGl0eS5wcm9jZXNzaW5nLmluZ3JlZGllbnRzfSlcclxuICAgIH1cclxuICAgIGxldCBidWZmZXIgPSBJZ29yLmdldElkKGVudGl0eS5idWZmZXJzLmluKVxyXG4gICAgSWdvci5wcm9jZXNzVEVNUChcInBsYXllci5pbnZlbnRvcnlcIiwgXCJpbnZlbnRvcnkuYWRkXCIsIHtpdGVtU3RhY2tzOiBidWZmZXIuaXRlbXN9KVxyXG4gICAgLy8hIElmIGFyZ3MucmV0dXJuVG8gaXMgZnVsbCwgJ2ludmVudG9yeS5hZGQnIHdpbGwgZmFpbCBzaWxlbnRseVxyXG4gICAgYnVmZmVyLml0ZW1zLmxlbmd0aCA9IDBcclxuICAgIGJ1ZmZlci54ZmVyU3RhY2sgPSAwXHJcbiAgICBidWZmZXIuc3RhbGxlZCA9IGZhbHNlXHJcbiAgfVxyXG4gIGlmKGVudGl0eS5idWZmZXJzLm91dCkge1xyXG4gICAgbGV0IGJ1ZmZlciA9IElnb3IuZ2V0SWQoZW50aXR5LmJ1ZmZlcnMub3V0KVxyXG4gICAgSWdvci5wcm9jZXNzVEVNUChcInBsYXllci5pbnZlbnRvcnlcIiwgXCJpbnZlbnRvcnkuYWRkXCIsIHtpdGVtU3RhY2tzOiBidWZmZXIuaXRlbXN9KVxyXG4gICAgLy8hIElmIGFyZ3MucmV0dXJuVG8gaXMgZnVsbCwgJ2ludmVudG9yeS5hZGQnIHdpbGwgZmFpbCBzaWxlbnRseVxyXG4gICAgYnVmZmVyLml0ZW1zLmxlbmd0aCA9IDBcclxuICAgIGJ1ZmZlci54ZmVyU3RhY2sgPSAwXHJcbiAgICBidWZmZXIuc3RhbGxlZCA9IGZhbHNlXHJcbiAgfVxyXG4gIGlmKGVudGl0eS5idWZmZXJzLnN0YWxsZWQpIHtcclxuICAgIElnb3IucHJvY2Vzc1RFTVAoXCJwbGF5ZXIuaW52ZW50b3J5XCIsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogZW50aXR5LmJ1ZmZlcnMuc3RhbGxlZH0pXHJcbiAgICBlbnRpdHkuYnVmZmVycy5zdGFsbGVkID0gbnVsbFxyXG4gIH1cclxuICBlbnRpdHkucHJvY2Vzc2luZyA9IG51bGxcclxufVxyXG5JZ29ySnMuYWRkT3BlcmF0aW9uKFwiZW50aXR5LmNsZWFyUHJvY2Vzc1wiLCBFbnRpdHlDbGVhclByb2Nlc3MpXHJcblxyXG5cclxuLypcclxuICBCdWZmZXJzXHJcbiAqL1xyXG5JZ29ySnMuc2V0U3RhdGljKFwiZW50aXR5QnVmZmVyLnNpemVFeHBhbnNpb25Db3N0XCIsIFt7bmFtZTogXCJpcm9uLWNoZXN0XCIsIGNvdW50OiAxfV0pXHJcbklnb3JKcy5zZXRTdGF0aWMoXCJlbnRpdHlCdWZmZXIueGZlckV4cGFuc2lvbkNvc3RcIiwgW3tuYW1lOiBcImluc2VydGVyXCIsICAgY291bnQ6IDF9XSlcclxuXHJcbmNvbnN0IE5ld0VudGl0eUJ1ZmZlciA9IChwYXJhbXMsIG5ld09iaiwgSWdvcikgPT4ge1xyXG4gIG5ld09iai51cGdyYWRlcyA9IHt9XHJcbiAgbmV3T2JqLm1heFN0YWNrcyA9IHBhcmFtcy5zdGF0aWNTdGFja3M/Lmxlbmd0aCB8fCBwYXJhbXMuc3RhY2tzIHx8IDFcclxuICBuZXdPYmouc3RhY2tTaXplID0gcGFyYW1zLnN0YWNrU2l6ZSB8fCA1XHJcbiAgbmV3T2JqLml0ZW1zID0gKHBhcmFtcy5zdGF0aWNTdGFja3M/Lm1hcCgoeCkgPT4ge3JldHVybiB7bmFtZTogeCwgY291bnQ6IDB9fSkpIHx8IFtdXHJcbiAgbmV3T2JqLnhmZXIgPSAwXHJcbiAgbmV3T2JqLnhmZXJUaWNrcyA9IDEyMFxyXG4gIG5ld09iai54ZmVyU3RhY2sgPSAwXHJcbiAgbmV3T2JqLmJ1c1NoaWZ0ID0gMFxyXG4gIG5ld09iai54ZmVyVGltZXIgPSBOYU5cclxuICBuZXdPYmoucmVzdHJpY3RhYmxlID0gcGFyYW1zLnJlc3RyaWN0YWJsZSB8fCBmYWxzZVxyXG4gIG5ld09iai5jb25uZWN0aW9uID0gbnVsbFxyXG4gIG5ld09iai5kaXIgPSBwYXJhbXMuZGlyXHJcbiAgbmV3T2JqLmFjdGl2ZSA9IGZhbHNlXHJcbiAgcmV0dXJuIFtuZXdPYmpdXHJcbn1cclxuTmV3RW50aXR5QnVmZmVyLl9kZWxldGUgPSAob2JqLCBJZ29yKSA9PiB7XHJcbiAgbGV0IGludiA9IElnb3IuZ2V0TmFtZWRPYmplY3QoXCJwbGF5ZXIuaW52ZW50b3J5XCIpXHJcbiAgb2JqLnVwZ3JhZGVzLmJ1ZmZlclNpemU/LmNvdW50ICYmIElnb3IucHJvY2Vzc1RFTVAoaW52LCBcImludmVudG9yeS5hZGRcIiwge2l0ZW1TdGFja3M6IElnb3IuZ2V0U3RhdGljKFwiZW50aXR5QnVmZmVyLnNpemVFeHBhbnNpb25Db3N0XCIpLCBtdWx0aTogb2JqLnVwZ3JhZGVzLmJ1ZmZlclNpemUuY291bnQgfSlcclxuICBvYmoudXBncmFkZXMubG9hZGVyPy5jb3VudCAgICAgJiYgSWdvci5wcm9jZXNzVEVNUChpbnYsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogSWdvci5nZXRTdGF0aWMoXCJlbnRpdHlCdWZmZXIueGZlckV4cGFuc2lvbkNvc3RcIiksIG11bHRpOiBvYmoudXBncmFkZXMubG9hZGVyLmNvdW50IH0pXHJcbn1cclxuY29uc3QgRW50aXR5QnVmZmVyQWN0aW9ucyA9IHt9XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuQ29sbGVjdCA9IChvYmosIElnb3IpID0+IHtcclxuICBsZXQgYnVmZmVyID0gSWdvci5nZXRJZChvYmoud2hpY2guYnVmZmVyKVxyXG4gIGxldCBpZHggPSBidWZmZXIuaXRlbXMuZmluZEluZGV4KCAoeCkgPT4geyByZXR1cm4geC5uYW1lPT1vYmouaXRlbS5uYW1lIH0pXHJcbiAgaWYoaWR4PT0tMSkgeyBjb25zb2xlLndhcm4oXCJEaWRudCcgZmluZCB0aGUgcmlnaHQgaW5kZXhcIik7IGRlYnVnZ2VyIH1cclxuICBpZihidWZmZXIuaXRlbXNbaWR4XS5jb3VudD09PTApIHJldHVyblxyXG4gIElnb3IucHJvY2Vzc1RFTVAoXCJwbGF5ZXIuaW52ZW50b3J5XCIsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogYnVmZmVyLml0ZW1zW2lkeF19KVxyXG4gIGJ1ZmZlci5pdGVtc1tpZHhdLmNvdW50ID0gMFxyXG5cclxuICBJZ29yLmdldElkKGJ1ZmZlci4kX3BhcmVudCkuJF90YWdzLnB1c2goXCJ0aWNrXCIsIFwicHJvY2Vzc2luZ1wiKVxyXG4gIElnb3Iudmlldy5zaWduYWxlci5zaWduYWwoXCJidWZmZXJVcGRhdGVcIilcclxuICBidWZmZXIudXBncmFkZXMubG9hZGVyPy5jb3VudCAmJiBidWZmZXIuJF90YWdzLnB1c2goXCJ0aWNrXCIsIFwicHJvY2Vzc2luZ1wiKVxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuQ29sbGVjdC5zaWduYXR1cmUgPSB7XHJcbiAgd2hpY2g6ICdidWZmZXInLFxyXG4gIGl0ZW06ICduYW1lJyxcclxufVxyXG5FbnRpdHlCdWZmZXJBY3Rpb25zLkNvbGxlY3QuQ0NfcHJvdmlkZSA9IFwiZW50aXR5LmJ1ZmZlckNvbGxlY3RcIlxyXG5cclxuXHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuRmlsbCA9IChvYmosIElnb3IpID0+IHtcclxuICBsZXQgYnVmZmVyID0gSWdvci5nZXRJZChvYmoud2hpY2guYnVmZmVyKVxyXG4gIGxldCBpZHggPSBidWZmZXIuaXRlbXMuZmluZEluZGV4KCAoeCkgPT4geyByZXR1cm4geC5uYW1lPT1vYmouaXRlbS5uYW1lfSlcclxuICBpZihpZHg9PS0xKSB7IGNvbnNvbGUud2FybihcIkRpZG50JyBmaW5kIHRoZSByaWdodCBpbmRleFwiKTsgZGVidWdnZXIgfVxyXG4gIGxldCBhdmFpbCA9IElnb3IucHJvY2Vzc1RFTVAoXCJwbGF5ZXIuaW52ZW50b3J5XCIsIFwiaW52ZW50b3J5LnRvdGFsXCIsIHtuYW1lOiBidWZmZXIuaXRlbXNbaWR4XS5uYW1lfSlcclxuICBpZihhdmFpbD09PTApIHJldHVyblxyXG4gIGxldCB0b01vdmUgPSBvYmouc2VydmljZS5yb3VuZGVyLmNhbGMoYnVmZmVyLml0ZW1zW2lkeF0uY291bnQsIGJ1ZmZlci5zdGFja1NpemUsIGF2YWlsKVxyXG4gIElnb3IucHJvY2Vzc1RFTVAoXCJwbGF5ZXIuaW52ZW50b3J5XCIsIFwiaW52ZW50b3J5LmNvbnN1bWVcIiwge2l0ZW1TdGFja3M6IHtuYW1lOiBidWZmZXIuaXRlbXNbaWR4XS5uYW1lLCBjb3VudDogdG9Nb3ZlfX0pXHJcbiAgYnVmZmVyLml0ZW1zW2lkeF0uY291bnQgKz0gdG9Nb3ZlXHJcblxyXG4gIElnb3IuZ2V0SWQoYnVmZmVyLiRfcGFyZW50KS4kX3RhZ3MucHVzaChcInRpY2tcIiwgXCJwcm9jZXNzaW5nXCIpXHJcbiAgSWdvci52aWV3LnNpZ25hbGVyLnNpZ25hbChcImJ1ZmZlclVwZGF0ZVwiKVxyXG4gIGJ1ZmZlci51cGdyYWRlcy5sb2FkZXI/LmNvdW50ICYmIGJ1ZmZlci4kX3RhZ3MucHVzaChcInRpY2tcIiwgXCJwcm9jZXNzaW5nXCIpXHJcbn1cclxuRW50aXR5QnVmZmVyQWN0aW9ucy5GaWxsLnNpZ25hdHVyZSA9IHtcclxuICB3aGljaDogJ2J1ZmZlcicsXHJcbiAgaXRlbTogJ25hbWUnLFxyXG4gIHNlcnZpY2U6ICdyb3VuZGVyJyxcclxufVxyXG5FbnRpdHlCdWZmZXJBY3Rpb25zLkZpbGwuQ0NfcHJvdmlkZSA9IFwiZW50aXR5LmJ1ZmZlckZpbGxcIlxyXG5cclxuRW50aXR5QnVmZmVyQWN0aW9ucy5DbGlja0N5Y2xlID0gKG9iaiwgSWdvcikgPT4ge1xyXG4gIC8vIFRoZSBwdXJwb3NlIGlzIHRvIGN5Y2xlIGJldHdlZW4gYnVmZmVyX2ZpbGwgYW5kIGJ1ZmZlcl9jb2xsZWN0XHJcbiAgbGV0IGJ1ZmZlciA9IElnb3IuZ2V0SWQob2JqLndoaWNoLmJ1ZmZlcilcclxuICBsZXQgaXRlbUVsbSA9IGJ1ZmZlci5pdGVtcy5maW5kKCh4KT0+IHtyZXR1cm4geC5uYW1lPT1vYmouaXRlbS5uYW1lfSlcclxuICBkZWJ1Z2dlclxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuQ2xpY2tDeWNsZS5zaWduYXR1cmUgPSB7XHJcbiAgd2hpY2g6ICdidWZmZXInLFxyXG4gIGl0ZW06ICduYW1lJyxcclxuICBzZXJ2aWNlOiAncm91bmRlcidcclxufVxyXG5FbnRpdHlCdWZmZXJBY3Rpb25zLkNsaWNrQ3ljbGUuQ0NfcHJvdmlkZSA9IFwiZW50aXR5LmJ1ZmZlckN5Y2xlXCJcclxuXHJcblxyXG5JZ29ySnMuc2V0U3RhdGljKFwiZW50aXR5LmJ1ZmZlci5CVUZGRVJfU0laRVwiLCAgWzUsIDEwLCAyMCwgMzAsIDQwLCA1MF0pXHJcbklnb3JKcy5zZXRTdGF0aWMoXCJlbnRpdHkuYnVmZmVyLkJVRkZFUl9TSVpFLk1BWFwiLCA1MClcclxuXHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuVXBncmFkZSA9IChvYmosIElnb3IpID0+IHtcclxuICBsZXQgYnVmZmVyID0gIElnb3IuZ2V0SWQob2JqLndoaWNoLmJ1ZmZlcilcclxuICBpZihvYmoudHlwZS5zdHJpbmc9PVwiYXV0b2xvYWRcIikge1xyXG4gICAgaWYoYnVmZmVyLnVwZ3JhZGVzLmxvYWRlcj8uY291bnQ+PTEwKSByZXR1cm4gSWdvci52aWV3Lndhcm5Ub2FzdChcIkxvYWRlcnMgZnVsbFwiKVxyXG4gICAgaWYoIUlnb3IucHJvY2Vzc1RFTVAob2JqLnBsYXllci5pbnZlbnRvcnksIFwiaW52ZW50b3J5LmNvbnN1bWVcIiwge2l0ZW1TdGFja3M6IHtuYW1lOiBcImluc2VydGVyXCIsIGNvdW50OiAxfX0pKSByZXR1cm4gSWdvci52aWV3Lndhcm5Ub2FzdChcIkluc2VydGVyIHJlcXVpcmVkXCIpXHJcbiAgICAhYnVmZmVyLnVwZ3JhZGVzLmxvYWRlciAmJiAoYnVmZmVyLnVwZ3JhZGVzLmxvYWRlciA9IHtjb3VudDogMH0pXHJcbiAgICBidWZmZXIudXBncmFkZXMubG9hZGVyLmNvdW50KytcclxuICAgIGJ1ZmZlci54ZmVyVGltZXIgfHwgKGJ1ZmZlci54ZmVyVGltZXIgPSBidWZmZXIueGZlclRpY2tzKVxyXG4gICAgYnVmZmVyLnhmZXIrK1xyXG4gICAgYnVmZmVyLmFjdGl2ZSA9IHRydWVcclxuICAgIGJ1ZmZlci4kX3RhZ3MucHVzaChcInRpY2tcIiwgXCJwcm9jZXNzaW5nXCIpXHJcbiAgfSBlbHNlIGlmKG9iai50eXBlLnN0cmluZz09XCJidWZmZXJcIikge1xyXG4gICAgaWYoYnVmZmVyLnVwZ3JhZGVzLmJ1ZmZlclNpemU/LmNvdW50Pj02KSByZXR1cm4gSWdvci52aWV3Lndhcm5Ub2FzdChcIkNoZXN0cyBmdWxsXCIpXHJcbiAgICBpZighSWdvci5wcm9jZXNzVEVNUChvYmoucGxheWVyLmludmVudG9yeSwgXCJpbnZlbnRvcnkuY29uc3VtZVwiLCB7aXRlbVN0YWNrczoge25hbWU6IFwiaXJvbi1jaGVzdFwiLCBjb3VudDogMX19KSkgcmV0dXJuIElnb3Iudmlldy53YXJuVG9hc3QoXCJJcm9uIGNoZXN0IHJlcXVpcmVkXCIpXHJcblxyXG4gICAgIWJ1ZmZlci51cGdyYWRlcy5idWZmZXJTaXplICYmIChidWZmZXIudXBncmFkZXMuYnVmZmVyU2l6ZSA9IHtjb3VudDogMH0pXHJcbiAgICBidWZmZXIudXBncmFkZXMuYnVmZmVyU2l6ZS5jb3VudCsrXHJcbiAgICBidWZmZXIuc3RhY2tTaXplID0gSWdvci5nZXRTdGF0aWMoXCJlbnRpdHkuYnVmZmVyLkJVRkZFUl9TSVpFXCIpW2J1ZmZlci51cGdyYWRlcy5idWZmZXJTaXplLmNvdW50XSB8fCBJZ29yLmdldFN0YXRpYyhcImVudGl0eS5idWZmZXIuQlVGRkVSX1NJWkUuTUFYXCIpXHJcbiAgfVxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuVXBncmFkZS5zaWduYXR1cmUgPSB7XHJcbiAgd2hpY2g6IFwiYnVmZmVyXCIsXHJcbiAgdHlwZTogXCJzdHJpbmdcIixcclxuICBwbGF5ZXI6ICdpbnZlbnRvcnknLFxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuVXBncmFkZS5DQ19wcm92aWRlID0gXCJlbnRpdHkuYnVmZmVyVXBncmFkZVwiXHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuU2V0UmVzdHJpY3Rpb25zID0gKHRhcmdldCwgYXJncywgcmV0dXJuT2JqLCBJZ29yKSA9PiB7XHJcbiAgaWYoIXRhcmdldC5yZXN0cmljdGFibGUpIHJldHVybk9iai5fcmVzdWx0ID0gZmFsc2VcclxuICAvL2NoZWNrIHRocm91Z2ggdGhlIGxpc3QgYW5kIHJldHVybiB0aGluZ3MgdG8gcGxheWVyIGJ1ZmZlclxyXG4gIGxldCBjb25uZWN0ZWQgPSBbXVxyXG4gIGxldCBlbXB0eUlkeHMgPSBbXVxyXG4gIHRhcmdldC5tYXhTdGFja3MgPSBhcmdzLmxpc3QubGVuZ3RoXHJcbiAgZm9yKGxldCBpZHg9MDsgaWR4PHRhcmdldC5pdGVtcy5sZW5ndGg7IGlkeCsrKSAge1xyXG4gICAgbGV0IHggPSB0YXJnZXQuaXRlbXNbaWR4XVxyXG4gICAgaWYoIXgpIHtlbXB0eUlkeHMucHVzaChpZHgpOyBjb250aW51ZX1cclxuICAgIGlmKCFhcmdzLmxpc3QuaW5jbHVkZXMoeC5uYW1lKSkge1xyXG4gICAgICBpZih4LmNvdW50PjApIElnb3IucHJvY2Vzc1RFTVAoXCJwbGF5ZXIuaW52ZW50b3J5XCIsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogeH0pXHJcbiAgICAgIHRhcmdldC5pdGVtcy5zcGxpY2UoaWR4LCAxLCB1bmRlZmluZWQpXHJcbiAgICAgIGVtcHR5SWR4cy5wdXNoKGlkeClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbm5lY3RlZC5wdXNoKHgubmFtZSlcclxuICAgICAgeC5yZXN0cmljdGVkID0gdHJ1ZVxyXG4gICAgfVxyXG4gIH1cclxuICAvL2NvbnNvbGUubG9nKGVtcHR5SWR4cylcclxuICBhcmdzLmxpc3QuZm9yRWFjaCggKHgpID0+IHtcclxuICAgIGlmKCFjb25uZWN0ZWQuaW5jbHVkZXMoeCkpIHtcclxuICAgICAgaWYoZW1wdHlJZHhzLmxlbmd0aD4wKSB7XHJcbiAgICAgICAgdGFyZ2V0Lml0ZW1zLnNwbGljZShlbXB0eUlkeHMuc3BsaWNlKDAsMSksIDEsIHtuYW1lOiB4LCBjb3VudDogMCwgcmVzdHJpY3RlZDp0cnVlfSlcclxuICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVzdHJpY3RlZCBzcGxpY2UgXCIreClcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0YXJnZXQuaXRlbXMucHVzaCh7bmFtZTogeCwgY291bnQ6IDAsIHJlc3RyaWN0ZWQ6IHRydWV9KVxyXG4gICAgICAgIC8vY29uc29sZS5sb2coJ3B1c2ggcmVzdHJpY3RlZDonK3gpXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KVxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuU2V0UmVzdHJpY3Rpb25zLklnb3Jfb3BlcmF0aW9uID0gXCJidWZmZXIucmVzdHJpY3RMaXN0XCJcclxuRW50aXR5QnVmZmVyQWN0aW9ucy5IYXNSZXN0cmljdGlvbiA9ICh0YXJnZXQsIGFyZ3MsIHJldHVybk9iaiwgSWdvcikgPT4ge1xyXG4gIGlmKCF0YXJnZXQucmVzdHJpY3RhYmxlKSByZXR1cm5PYmouX3Jlc3VsdCA9IGZhbHNlXHJcbiAgZWxzZSB7XHJcbiAgICB0YXJnZXQuaXRlbXMuZm9yRWFjaCggKHgpID0+IHtcclxuICAgICAgaWYoeC5uYW1lID09IGFyZ3MuaXRlbU5hbWUpIHtcclxuICAgICAgICBpZih4LnJlc3RyaWN0ZWRCeS5pbmNsdWRlcyhhcmdzLmxpbmVJZCkpIHtcclxuICAgICAgICAgIHJldHVybk9iai5fcmVzdWx0ID0ge2ZvdW5kOiB0cnVlLCByZXN0cmljdGVkOiB0cnVlfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm5PYmouX3Jlc3VsdCA9IHtmb3VuZDogdHJ1ZSwgcmVzdHJpY3RlZDogZmFsc2V9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuICAhcmV0dXJuT2JqLl9yZXN1bHQgJiYgKHJldHVybk9iai5fcmVzdWx0ID0ge2ZvdW5kOiBmYWxzZSwgcmVzdHJpY3RlZDogZmFsc2V9KVxyXG59XHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuSGFzUmVzdHJpY3Rpb24uSWdvcl9vcGVyYXRpb24gPSBcImJ1ZmZlci5oYXNSZXN0cmljdGlvblwiXHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuQ2xlYXJSZXN0cmljdGlvbiA9ICh0YXJnZXQsIGFyZ3MsIHJldHVybk9iaiwgSWdvcikgPT4ge1xyXG4gIGlmKCF0YXJnZXQucmVzdHJpY3RhYmxlKSByZXR1cm5PYmouX3Jlc3VsdCA9IGZhbHNlXHJcbiAgbGV0IGlkeCA9IC0xXHJcbiAgd2hpbGUoIShcIl9yZXN1bHRcIiBpbiByZXR1cm5PYmopKSB7XHJcbiAgICBsZXQgeCA9IHRhcmdldC5pdGVtc1srK2lkeF1cclxuICAgIGlmKHgubmFtZSA9PSBhcmdzLml0ZW1OYW1lKSB7XHJcbiAgICAgIHgucmVzdHJpY3RlZEJ5LnNwbGljZSh4LnJlc3RyaWN0ZWRCeS5pbmRleE9mKGFyZ3MubGluZUlkKSwgMSlcclxuICAgICAgaWYoeC5yZXN0cmljdGVkQnkubGVuZ3RoPT0wKSB7XHJcbiAgICAgICAgdGFyZ2V0Lml0ZW1zW2lkeF0gPSBudWxsXHJcbiAgICAgICAgcmV0dXJuT2JqLl9yZXN1bHQgPSB7Zm91bmQ6IHRydWUsIGNsZWFyZWQ6IHRydWV9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuT2JqLl9yZXN1bHQgPSB7Zm91bmQ6IHRydWUsIGNsZWFyZWQ6IGZhbHNlfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gICFyZXR1cm5PYmouX3Jlc3VsdCAmJiAocmV0dXJuT2JqLl9yZXN1bHQgPSB7Zm91bmQ6IGZhbHNlLCBjbGVhcmVkOiBmYWxzZX0pXHJcbn1cclxuXHJcbkVudGl0eUJ1ZmZlckFjdGlvbnMuQ2xlYXJSZXN0cmljdGlvbi5JZ29yX29wZXJhdGlvbiA9IFwiYnVmZmVyLmNsZWFyUmVzdHJpY3Rpb25cIlxyXG5FbnRpdHlCdWZmZXJBY3Rpb25zLkJ1c1hmZXIgPSAodGFyZ2V0LCBhcmdzLCByZXR1cm5PYmosIElnb3IpID0+IHtcclxuICAvL1RPRE8gbmVlZCBiZXR0ZXIgcHJvdGVjdGlvbnMgZm9yIHRyYW5zZmVyc1xyXG4gIC8vVE9ETyBuZWVkIHRvIGhhbmRsZSBkaWZmZXJlbnQgaXRlbSBzdGFja3NcclxuICAvLyBzZXR1cCBmaWx0ZXIgcHJpb3JpdGllcyBmb3Igb3V0cHV0IFxyXG4gIGlmKGFyZ3MudG9CdXMpIHtcclxuICAgIHdoaWxlKGFyZ3MueGZlckNvdW50PjApIHtcclxuICAgICAgaWYoIXRhcmdldC5pdGVtc1t0YXJnZXQuYnVzU2hpZnRdKSByZXR1cm4gbnVsbFxyXG4gICAgICBsZXQgYWRkZWQgPSBJZ29yLnByb2Nlc3NURU1QKGFyZ3MudG9CdXMsIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogW3tuYW1lOiB0YXJnZXQuaXRlbXNbdGFyZ2V0LmJ1c1NoaWZ0XS5uYW1lLCBjb3VudDogYXJncy54ZmVyQ291bnR9XX0pXHJcbiAgICAgIGlmKGFkZGVkLmNvbXBsZXRlKSB7XHJcbiAgICAgICAgSWdvci5wcm9jZXNzVEVNUCh0YXJnZXQsIFwiaW52ZW50b3J5LmNvbnN1bWVcIiwge2l0ZW1TdGFja3M6IFt7bmFtZTogdGFyZ2V0Lml0ZW1zW3RhcmdldC5idXNTaGlmdF0ubmFtZSwgY291bnQ6IGFyZ3MueGZlckNvdW50fV19KVxyXG4gICAgICAgIGFyZ3MueGZlckNvdW50PTBcclxuICAgICAgfSBlbHNlIGlmKGFkZGVkLnBhcnRbMF0uY291bnQ9PWFyZ3MueGZlckNvdW50KSB7XHJcbiAgICAgICAgcmV0dXJuT2JqLmZ1bGwgPSB0cnVlXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgSWdvci5wcm9jZXNzVEVNUCh0YXJnZXQsIFwiaW52ZW50b3J5LmNvbnN1bWVcIiwge2l0ZW1TdGFja3M6IFt7bmFtZTogdGFyZ2V0Lml0ZW1zW3RhcmdldC5idXNTaGlmdF0ubmFtZSwgY291bnQ6IGFyZ3MueGZlckNvdW50LWFkZGVkLnBhcnRbMF0uY291bnR9XX0pXHJcbiAgICAgICAgYXJncy54ZmVyQ291bnQgPSBhZGRlZC5wYXJ0WzBdLmNvdW50XHJcbiAgICAgIH1cclxuICAgICAgKyt0YXJnZXQuYnVzU2hpZnQ9PXRhcmdldC5pdGVtcy5sZW5ndGggJiYgKHRhcmdldC5idXNTaGlmdD0wKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuT2JqLmNvbXBsZXRlID0gdHJ1ZVxyXG4gIH0gZWxzZSBpZiAoYXJncy5mcm9tQnVzKSB7XHJcbiAgICBsZXQgbG9vcHMgPSAwXHJcbiAgICB3aGlsZShhcmdzLnhmZXJDb3VudD4wKSB7XHJcbiAgICAgIGlmKCF0YXJnZXQuaXRlbXNbdGFyZ2V0LmJ1c1NoaWZ0XSkgcmV0dXJuIG51bGxcclxuICAgICAgbGV0IHNwYWNlID0gdGFyZ2V0LnN0YWNrU2l6ZSAtICB0YXJnZXQuaXRlbXNbdGFyZ2V0LmJ1c1NoaWZ0XS5jb3VudFxyXG4gICAgICBpZihzcGFjZSkge1xyXG4gICAgICAgIGxldCBjb25zdW1lZCA9IElnb3IucHJvY2Vzc1RFTVAoYXJncy5mcm9tQnVzLCBcImludmVudG9yeS5jb25zdW1lXCIsIHtpdGVtU3RhY2tzOiBbe25hbWU6IHRhcmdldC5pdGVtc1t0YXJnZXQuYnVzU2hpZnRdLm5hbWUsIGNvdW50OiBNYXRoLm1pbihhcmdzLnhmZXJDb3VudCwgc3BhY2UpfV0sIHBhcnRpYWw6IHRydWV9KVxyXG4gICAgICAgIGlmKGNvbnN1bWVkWzBdLmNvdW50PjApIHtcclxuICAgICAgICAgIElnb3IucHJvY2Vzc1RFTVAodGFyZ2V0LCBcImludmVudG9yeS5hZGRcIiwge2l0ZW1TdGFja3M6IFt7bmFtZTogdGFyZ2V0Lml0ZW1zW3RhcmdldC5idXNTaGlmdF0ubmFtZSwgY291bnQ6IGNvbnN1bWVkWzBdLmNvdW50fV19KVxyXG4gICAgICAgICAgYXJncy54ZmVyQ291bnQtPWNvbnN1bWVkWzBdLmNvdW50XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKCsrbG9vcHM9PXRhcmdldC5pdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm5PYmouZnVsbCA9IHRydWVcclxuICAgICAgICByZXR1cm5cclxuICAgICAgfVxyXG4gICAgICArK3RhcmdldC5idXNTaGlmdD09dGFyZ2V0Lml0ZW1zLmxlbmd0aCAmJiAodGFyZ2V0LmJ1c1NoaWZ0PTApXHJcbiAgICB9XHJcbiAgICByZXR1cm5PYmouY29tcGxldGUgPSB0cnVlXHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnNvbGUud2FybihcIkJ1c1hmZXIgY2FsbGVkIF9fIG5vIGJ1cyB0YXJnZXRcIilcclxuICB9XHJcbn1cclxuRW50aXR5QnVmZmVyQWN0aW9ucy5CdXNYZmVyLklnb3Jfb3BlcmF0aW9uID0gXCJidWZmZXIuYnVzWGZlclwiXHJcblxyXG5FbnRpdHlCdWZmZXJBY3Rpb25zLkJ1ZmZlclN0YWxsZWQgPSAoYnVmZmVyLCBhcmdzLCByZXR1cm5PYmosIElnb3IpID0+IHtcclxuICAvKiBtb3JlIGFkdmFuY2VkIHN0YWxsIGhhbmRsaW5nLCB0aGVuIHJldHVybiovXHJcbiAgLy9jb25zb2xlLmxvZygnc3RhbGxlZCBzdGFydCcrYnVmZmVyLml0ZW1zLmxlbmd0aClcclxuICBidWZmZXIuc3RhbGxlZCA9IHRydWVcclxuICBidWZmZXIueGZlclRpbWVyID0gTWF0aC5mbG9vcihidWZmZXIueGZlclRpY2tzLzYpXHJcbiAgKytidWZmZXIueGZlclN0YWNrPT1idWZmZXIuaXRlbXMubGVuZ3RoICYmIChidWZmZXIueGZlclN0YWNrPTApXHJcbn1cclxuRW50aXR5QnVmZmVyQWN0aW9ucy5CdWZmZXJTdGFsbGVkLklnb3Jfb3BlcmF0aW9uID0gXCJidWZmZXIuc2V0U3RhbGxcIlxyXG5cclxuRW50aXR5QnVmZmVyQWN0aW9ucy50aWNrID0gKGJ1ZmZlciwgdGlja0RhdGEsIElnb3IpID0+IHtcclxuICBpZihidWZmZXIuaXRlbXMubGVuZ3RoPT0wIHx8ICFidWZmZXIuYWN0aXZlKSByZXR1cm5cclxuICBpZihidWZmZXIueGZlclRpbWVyKSByZXR1cm4gYnVmZmVyLnhmZXJUaW1lci0tXHJcbiAgLy9TdXJlbHkgYSBtb3JlIGVsZWdhbnQgd2F5IHRvIHJ1biB0aGlzLi4uXHJcbiAgLy9UT0RPIG5lZWQgdG8gYWx0ZXIgc3RhY2tzIGlmIG5vdCBjb21wbGV0ZWx5IHhmZXJkXHJcbiAgaWYoYnVmZmVyLmRpcj09J2luJykge1xyXG4gICAgbGV0IHRvQWRkID0gTWF0aC5taW4oYnVmZmVyLnhmZXIsIGJ1ZmZlci5zdGFja1NpemUtYnVmZmVyLml0ZW1zW2J1ZmZlci54ZmVyU3RhY2tdLmNvdW50KVxyXG4gICAgaWYodG9BZGQ9PTApIHJldHVybiBJZ29yLnByb2Nlc3NURU1QKGJ1ZmZlciwgXCJidWZmZXIuc2V0U3RhbGxcIilcclxuICAgIGxldCBhY3F1aXJlZCA9IElnb3IucHJvY2Vzc1RFTVAoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJwbGF5ZXIuaW52ZW50b3J5XCJcclxuICAgICAgICAgICAgICAgICAgICAsXCJpbnZlbnRvcnkuY29uc3VtZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgLHtpdGVtU3RhY2tzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGJ1ZmZlci5pdGVtc1tidWZmZXIueGZlclN0YWNrXS5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICxjb3VudDogdG9BZGRcclxuICAgICAgICAgICAgICAgICAgICAgfSwgcGFydGlhbDogdHJ1ZX0pXHJcbiAgICBpZihhY3F1aXJlZFswXS5jb3VudD09MCkgcmV0dXJuIElnb3IucHJvY2Vzc1RFTVAoYnVmZmVyLCBcImJ1ZmZlci5zZXRTdGFsbFwiKVxyXG4gICAgYnVmZmVyLml0ZW1zW2J1ZmZlci54ZmVyU3RhY2tdLmNvdW50ICs9IGFjcXVpcmVkWzBdLmNvdW50XHJcbiAgfSBlbHNlIHtcclxuICAgIGxldCB4ZmVyID0gYnVmZmVyLml0ZW1zW2J1ZmZlci54ZmVyU3RhY2tdXHJcbiAgICBsZXQgYWRkZWQgPSBJZ29yLnByb2Nlc3NURU1QKFxyXG4gICAgICAgICAgICAgICAgICAgXCJwbGF5ZXIuaW52ZW50b3J5XCJcclxuICAgICAgICAgICAgICAgICAgICxcImludmVudG9yeS5hZGRcIlxyXG4gICAgICAgICAgICAgICAgICAgLHtpdGVtU3RhY2tzOiB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgbmFtZTogeGZlci5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAsY291bnQ6IE1hdGgubWluKHhmZXIuY291bnQsIGJ1ZmZlci54ZmVyKVxyXG4gICAgICAgICAgICAgICAgICAgfSwgc3RhY2tMaW1pdDogMX0pXHJcbiAgICAvL2NvbnNvbGUubG9nKGFkZGVkKVxyXG4gICAgaWYoIWFkZGVkLmNvbXBsZXRlKSByZXR1cm4gSWdvci5wcm9jZXNzVEVNUChidWZmZXIsIFwiYnVmZmVyLnNldFN0YWxsXCIpXHJcbiAgICB4ZmVyLmNvdW50IC09IE1hdGgubWluKHhmZXIuY291bnQsIGJ1ZmZlci54ZmVyKVxyXG4gICAgLy9cclxuICB9XHJcbiAgKytidWZmZXIueGZlclN0YWNrPT1idWZmZXIuaXRlbXMubGVuZ3RoICYmIChidWZmZXIueGZlclN0YWNrPTApXHJcbiAgYnVmZmVyLnhmZXJUaW1lciA9IGJ1ZmZlci54ZmVyVGlja3NcclxuICBidWZmZXIuc3RhbGxlZCA9IGZhbHNlXHJcbiAgSWdvci5nZXRJZChidWZmZXIuJF9wYXJlbnQpLiRfdGFncy5wdXNoKFwidGlja1wiLCBcInByb2Nlc3NpbmdcIilcclxuICBJZ29yLnZpZXcuc2lnbmFsZXIuc2lnbmFsKFwiYnVmZmVyVXBkYXRlXCIpXHJcbn1cclxuXHJcbklnb3JKcy5kZWZpbmVPYmooXCJlbnRpdHkuYnVmZmVyXCIsIE5ld0VudGl0eUJ1ZmZlciwgRW50aXR5QnVmZmVyQWN0aW9ucylcclxuXHJcblxyXG5cclxuLypcclxuICogIFJlc2VhcmNoIFJlbGF0ZWRcclxuICpcclxuICovXHJcblxyXG5jb25zdCBTZXRSZXNlYXJjaFNpZyA9IHtcclxuICBcIndoaWNoXCI6IFwidGVjaFwiLFxyXG4gIFwiZ2xvYmFsXCI6IFwiZ2FtZVwiXHJcbn1cclxuY29uc3QgU2V0UmVzZWFyY2ggPSAgKG9iaiwgSWdvciwgc2VsZikgPT4ge1xyXG4gIG9iai5nbG9iYWwuZ2FtZS5yZXNlYXJjaC5wcm9ncmVzc2luZyA9IG9iai53aGljaC50ZWNoXHJcbiAgb2JqLmdsb2JhbC5nYW1lLnJlc2VhcmNoLnByb2dyZXNzaW5nLmNvbXBsZXRlVW5pdHMgPSAwXHJcbn1cclxuXHJcbklnb3JKcy5wcm92aWRlX0NDQyhcInJlc2VhcmNoLnNldFwiLCBTZXRSZXNlYXJjaCwgU2V0UmVzZWFyY2hTaWcpXHJcblxyXG5jb25zdCBDbGVhclJlc2VhcmNoU2lnID0ge1xyXG4gIFwiZ2xvYmFsXCI6IFwiZ2FtZVwiXHJcbn1cclxuY29uc3QgQ2xlYXJSZXNlYXJjaCA9IChvYmosIElnb3IsIHNlbGYpID0+IHtcclxuICBvYmouZ2xvYmFsLmdhbWUucmVzZWFyY2gucHJvZ3Jlc3NpbmcgPSBudWxsXHJcbn1cclxuSWdvckpzLnByb3ZpZGVfQ0NDKFwicmVzZWFyY2guY2xlYXJcIiwgQ2xlYXJSZXNlYXJjaCwgQ2xlYXJSZXNlYXJjaFNpZylcclxuXHJcbi8vUmV0dXJucyBleHRyYSBwb3J0aW9uLCBidXQgSSBkb24ndCBoYXZlIGEgZ29vZCBzb2x1dGlvblxyXG4vL1RvIGFkZGluZyBpdCBiYWNrIHRvIHRoZSBmYWN0b3J5QmxvY2tcclxuY29uc3QgUmVzZWFyY2hVcGRhdGUgPSAob2JqLCBhcmdzLCByZXR1cm5PYmosIElnb3IpID0+IHtcclxuICBsZXQgZ2xvYmFsID0gSWdvci5nZXROYW1lZE9iamVjdChcImdsb2JhbFwiKVxyXG4gIG9iai5jb21wbGV0ZVVuaXRzICs9IGFyZ3MuY291bnQgfHwgMVxyXG4gIGlmKG9iai5jb21wbGV0ZVVuaXRzPj1vYmouY29zdC5jb3VudCkge1xyXG4gICAgSWdvci52aWV3Lmdvb2RUb2FzdChcIlJlc2VhcmNoIENvbXBsZXRlOiBcIitvYmoubmFtZSlcclxuICAgIHJldHVybk9iai5fcmVzdWx0ID0gb2JqLmNvbXBsZXRlVW5pdHMtb2JqLmNvc3QuY291bnRcclxuICAgIElnb3IuZ2V0TmFtZWRPYmplY3QoXCJyZXNlYXJjaFwiKS5wcm9ncmVzc2luZyA9IG51bGxcclxuICAgIG9iai5yZXNlYXJjaGVkID0gdHJ1ZVxyXG4gICAgZ2xvYmFsLnJlc2VhcmNoLmNvbXBsZXRlZFtvYmoubmFtZV0gPSB0cnVlXHJcbiAgICBvYmoudW5sb2Nrcy5mb3JFYWNoKCAoaXRlbSkgPT4ge1xyXG4gICAgICB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgJiYgSWdvci5wcm9jZXNzVEVNUChpdGVtLCBcInJlY2lwZS51bmxvY2tcIilcclxuICAgICAgdHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIElnb3IucHJvY2Vzc1RFTVAoaXRlbSwgXCJmZWF0dXJlLnVubG9ja1wiKVxyXG4gICAgfSlcclxuICAgIGxldCBjb3N0ID0gb2JqLmNvc3QuaW5ncmVkaWVudHMubWFwKChbbmFtZSwgcXR5XSkgPT4ge3JldHVybiB7bmFtZSwgY291bnQ6cXR5fX0pXHJcbiAgICAvL1RPRE8hIG5lZWQgdG8gdXBkYXRlIHRoaXMgdG8gcmVzcG9uZCB0byBkaWZmZXJlbnQgdGVjaCB0cmVlc1xyXG4gICAgZ2xvYmFsLnBsYXllci53b3Jrc2hvcC5lbnRpdGllcy5mb3JFYWNoKCAoeCkgPT4ge1xyXG4gICAgICBsZXQgZW50ID0gSWdvci5nZXRJZCh4KVxyXG4gICAgICBpZihlbnQubmFtZT09XCJsYWJcIikge1xyXG4gICAgICAgIElnb3IucHJvY2Vzc1RFTVAoZW50LmJ1ZmZlcnMuaW4sIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogY29zdCwgZm9yY2U6IHRydWV9KVxyXG4gICAgICAgIGVudC5yZXNlYXJjaF90aW1lciA9IE5hTlxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgZ2xvYmFsLmZhY0Jsb2Nrcy50ZWNoQmxvY2tzLmZvckVhY2goICh4KSA9PiB7XHJcbiAgICAgIGlmKGFyZ3MubWU9PXgpIHJldHVyblxyXG4gICAgICBsZXQgYmxvY2sgPSBJZ29yLmdldElkKHgpXHJcbiAgICAgIGlmKGJsb2NrLnJlc2VhcmNoX2NvbnN1bWVkKSB7XHJcbiAgICAgICAgSWdvci5wcm9jZXNzVEVNUChibG9jay5idWZmZXJzLmluLCBcImludmVudG9yeS5hZGRcIiwge2l0ZW1TdGFja3M6IGNvc3QsIGZvcmNlOiB0cnVlLCBtdWx0aTogcmVzZWFyY2hfY29uc3VtZWR9KVxyXG4gICAgICAgIGJsb2NrLnJlc2VhcmNoX2NvbnN1bWVkID0gMCBcclxuICAgICAgICBibG9jay5yZXNlYXJjaF90aWNrcyA9IE5hTlxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgQ2hhbWVKcy5zaWduYWxlci5zaWduYWwoXCJ0ZWNoUmVzZWFyY2hlZFwiKVxyXG4gIH1cclxufVxyXG5cclxuSWdvckpzLmFkZE9wZXJhdGlvbihcInJlc2VhcmNoLnVwZGF0ZVwiLCBSZXNlYXJjaFVwZGF0ZSlcclxuXHJcbmNvbnN0IFJlY2lwZVVubG9jayA9IChvYmosIGFyZ3MsIHJldHVybk9iaiwgSWdvcikgPT4ge1xyXG4gIC8vSWdvci5kYXRhLnJlY2lwZVtvYmpdLmVuYWJsZWQgPSB0cnVlXHJcbiAgSWdvci5nZXROYW1lZE9iamVjdChcImdsb2JhbFwiKS51bmxvY2tlZF9yZWNpcGVzLnB1c2gob2JqKVxyXG59XHJcbklnb3JKcy5hZGRPcGVyYXRpb24oXCJyZWNpcGUudW5sb2NrXCIsIFJlY2lwZVVubG9jaylcclxuXHJcbmNvbnN0IEZlYXR1cmVVbmxvY2sgPSAob2JqLCBhcmdzLCByZXR1cm5PYmosIElnb3IpID0+IHtcclxuICBsZXQgZmVhdHVyZXMgPSBJZ29yLmdldE5hbWVkT2JqZWN0KFwiZ2xvYmFsXCIpLmFjdGl2ZUZlYXR1cmVzXHJcbiAgaWYoZmVhdHVyZXNbb2JqLmZlYXR1cmVdKSB7XHJcbiAgICBmZWF0dXJlc1tvYmouZmVhdHVyZV0gPSBvYmpcclxuICB9IGVsc2Uge1xyXG4gICAgLy8hIG5lZWRzIHNvbWV0aGluZyBtb3JlIGVsZWdhbnQuLi5cclxuICAgIGlmKG9iai5mZWF0dXJlPT1cImZhY3RvcnlCbG9ja3NcIikge1xyXG4gICAgICBsZXQgYmxvY2tzID0gSWdvci5nZXROYW1lZE9iamVjdChcImdsb2JhbFwiKS5mYWNCbG9ja3MuYmxvY2tzXHJcbiAgICAgIGlmKG9iai5ibG9ja3NNYXhTb3VyY2VzKSB7XHJcbiAgICAgICAgYmxvY2tzLmZvckVhY2goIChpZCkgPT4ge1xyXG4gICAgICAgICAgSWdvci5nZXRJZChpZCkuY29ubmVjdGlvbnMubWF4U291cmNlcyA9IG9iai5ibG9ja3NNYXhTb3VyY2VzXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgICBpZihvYmouYmxvY2tzTWF4RHJhaW5zKSB7XHJcbiAgICAgICAgYmxvY2tzLmZvckVhY2goIChpZCkgPT4ge1xyXG4gICAgICAgICAgSWdvci5nZXRJZChpZCkuY29ubmVjdGlvbnMubWF4RHJhaW5zID0gb2JqLmJsb2Nrc01heERyYWluc1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGRlYnVnZ2VyXHJcbiAgICBPYmplY3QuYXNzaWduKGZlYXR1cmVzW29iai5mZWF0dXJlXSwgb2JqKVxyXG4gIH1cclxuXHJcbiAgLypcclxuICBhZGp1c3RGZWF0dXJlKG9iaikge1xyXG4gICAgc3dpdGNoKG9iai5mZWF0dXJlKSB7XHJcbiAgICAgIGNhc2UgXCJkZWZlbnNlXCI6XHJcbiAgICAgICAgaWYoIXRoaXMuYWN0aXZlRmVhdHVyZXNbXCJkZWZlbnNlXCJdKSB7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZUZlYXR1cmVzW1wiZGVmZW5zZVwiXSA9IHRydWVcclxuICAgICAgICAgIHRoaXMuZmFjQmxvY2tzLmRlZmVuc2VzID0gTmFtZWRCbG9ja3MuRGVmZW5zZUJsb2NrKClcclxuICAgICAgICAgIHRoaXMuZmFjQmxvY2tzLmRlZmVuc2VCdXMgPSBOYW1lZEJsb2Nrcy5EZWZlbnNlQnVzKClcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5mYWNCbG9ja3MuZGVmZW5zZXMubWFjaGluZXNbXCJ0dXJyZXRcIl0gPSBDaGFtZVZpZXcuR2FtZU9iamVjdEZyb21Qb2ludGVyKG9iai5nb19wb2ludGVyKSAgLy8hISEgc2hvdWxkbid0IGJlIGluIENoYW1lbGVvblxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwib2ZmZW5zZVwiOlxyXG4gICAgICAgIGlmKCF0aGlzLmFjdGl2ZUZlYXR1cmVzW1wib2ZmZW5zZVwiXSkge1xyXG4gICAgICAgICAgdGhpcy5hY3RpdmVGZWF0dXJlc1tcIm9mZmVuc2VcIl0gPSB0cnVlXHJcbiAgICAgICAgICB0aGlzLmZhY0Jsb2Nrcy5vZmZlbnNlcyA9IE5hbWVkQmxvY2tzLk9mZmVuc2VCbG9jaygpXHJcbiAgICAgICAgICB0aGlzLmZhY0Jsb2Nrcy5vZmZlbnNlQnVzID0gTmFtZWRCbG9ja3MuT2ZmZW5zZUJ1cygpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmFjQmxvY2tzLm9mZmVuc2VzLnJhZGFyID0gQ2hhbWVWaWV3LkdhbWVPYmplY3RGcm9tUG9pbnRlcihvYmouZ29fcG9pbnRlcikgIC8vISEhIHNob3VsZG4ndCBiZSBpbiBDaGFtZWxlb25cclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcImZhY3RvcnlCbG9ja3NcIjpcclxuICAgICAgICB0aGlzLmFjdGl2ZUZlYXR1cmVzW1wiZmFjdG9yeUJsb2Nrc1wiXSA9IHRydWVcclxuICAgIH1cclxuICAgIC8vIHRoaXMuYWN0aXZlRmVhdHVyZXNbb2JqLmZlYXR1cmVdID0gb2JqLmxldmVsIHx8ICh0aGlzLmFjdGl2ZUZlYXR1cmVzW29iai5mZWF0dXJlXStvYmouaW5jKSB8fCAodGhpcy5hY3RpdmVGZWF0dXJlc1tvYmouZmVhdHVyZV0gKiBvYmouYm9udXMpIHx8IHRydWVcclxuICB9XHJcbiAgKi9cclxufVxyXG5JZ29ySnMuYWRkT3BlcmF0aW9uKFwiZmVhdHVyZS51bmxvY2tcIiwgRmVhdHVyZVVubG9jaylcclxuXHJcblxyXG5cclxuY29uc3QgQ3JhZnRGcm9tSW52ID0gKG9iaiwgSWdvciwgZm4pID0+IHtcclxuICBpZihmbi5yZWMpIHtcclxuICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoZm4udGltZW91dClcclxuICAgIElnb3IucHJvY2Vzc1RFTVAob2JqLnBsYXllci5pbnZlbnRvcnksIFwiaW52ZW50b3J5LmFkZFwiLCB7aXRlbVN0YWNrczogZm4ucmVjLmluZ3JlZGllbnRzfSlcclxuICAgIENoYW1lSnMuYW5pbXNVcGRhdGUoZm4ucmVjLCBudWxsLCBudWxsKVxyXG4gICAgZm4ucmVjID0gdW5kZWZpbmVkXHJcbiAgfSBlbHNlIHtcclxuICAgIGlmKElnb3IucHJvY2Vzc1RFTVAob2JqLnBsYXllci5pbnZlbnRvcnksIFwiaW52ZW50b3J5LmNvbnN1bWVcIiwge2l0ZW1TdGFja3M6IG9iai53aGljaC5yZWNpcGUuaW5ncmVkaWVudHMgfSkpIHtcclxuICAgICAgZm4ucmVjID0gb2JqLndoaWNoLnJlY2lwZVxyXG4gICAgICBmbi50aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcclxuICAgICAgICBJZ29yLnByb2Nlc3NURU1QKG9iai5wbGF5ZXIuaW52ZW50b3J5LCBcImludmVudG9yeS5hZGRcIiwge2l0ZW1TdGFja3M6IGZuLnJlYy5yZXN1bHRzfSlcclxuICAgICAgICBDaGFtZUpzLmFuaW1zVXBkYXRlKGZuLnJlYywgbnVsbCwgbnVsbClcclxuICAgICAgICBmbi5yZWMgPSB1bmRlZmluZWRcclxuICAgICAgfSwgb2JqLndoaWNoLnJlY2lwZS5jcmFmdGluZ19zcGVlZCAqIDEwMDApXHJcbiAgICAgIGZuLnJlYyA9IG9iai53aGljaC5yZWNpcGVcclxuICAgICAgQ2hhbWVKcy5hbmltc1VwZGF0ZShmbi5yZWMsIFwiaXNDcmFmdGluZ1wiLCBvYmoud2hpY2gucmVjaXBlLmNyYWZ0aW5nX3NwZWVkKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy9FcnJvciBhbGVydDogY2Fubm90IGJ1aWxkXHJcbiAgICAgIElnb3Iudmlldy53YXJuVG9hc3QoXCJOb3QgZW5vdWdoIGluZ3JlZGllbnRzIHRvIGNyYWZ0XCIpXHJcbiAgICAgIGNvbnNvbGUubG9nKCdjYW5ub3QgY3JhZnQnKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5DcmFmdEZyb21JbnYuc2lnbmF0dXJlID0ge1xyXG4gIHdoaWNoOiBcInJlY2lwZVwiLFxyXG4gIHBsYXllcjogXCJpbnZlbnRvcnlcIlxyXG59XHJcblxyXG5JZ29ySnMucHJvdmlkZV9DQ0MoXCJwbGF5ZXIuY3JhZnRcIiwgQ3JhZnRGcm9tSW52LCBDcmFmdEZyb21JbnYuc2lnbmF0dXJlKVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBRUE7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFKQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFHQTs7OztBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRkE7QUFHQTtBQUhBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBR0E7QUFIQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF5QkE7QUFDQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///iVpH\n");

/***/ })

}]);